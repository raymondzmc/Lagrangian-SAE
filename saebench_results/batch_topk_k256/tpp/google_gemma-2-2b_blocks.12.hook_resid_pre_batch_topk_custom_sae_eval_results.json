{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "2f9fbd71-9024-43b6-ae22-dc649e5d44f4",
  "datetime_epoch_millis": 1769390786685,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0029749974608421327,
      "tpp_threshold_2_intended_diff_only": 0.004099994897842407,
      "tpp_threshold_2_unintended_diff_only": 0.0011249974370002747,
      "tpp_threshold_5_total_metric": 0.006749996542930603,
      "tpp_threshold_5_intended_diff_only": 0.007999992370605469,
      "tpp_threshold_5_unintended_diff_only": 0.0012499958276748658,
      "tpp_threshold_10_total_metric": 0.01942499428987503,
      "tpp_threshold_10_intended_diff_only": 0.021899986267089843,
      "tpp_threshold_10_unintended_diff_only": 0.0024749919772148136,
      "tpp_threshold_20_total_metric": 0.05847500562667846,
      "tpp_threshold_20_intended_diff_only": 0.06290000081062316,
      "tpp_threshold_20_unintended_diff_only": 0.0044249951839447025,
      "tpp_threshold_50_total_metric": 0.17570001631975174,
      "tpp_threshold_50_intended_diff_only": 0.18390001058578492,
      "tpp_threshold_50_unintended_diff_only": 0.008199994266033173,
      "tpp_threshold_100_total_metric": 0.31627501398324964,
      "tpp_threshold_100_intended_diff_only": 0.3315000116825104,
      "tpp_threshold_100_unintended_diff_only": 0.01522499769926071,
      "tpp_threshold_500_total_metric": 0.41210003942251205,
      "tpp_threshold_500_intended_diff_only": 0.4437000393867493,
      "tpp_threshold_500_unintended_diff_only": 0.031599999964237215
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.004949986934661865,
      "tpp_threshold_2_intended_diff_only": 0.005799973011016845,
      "tpp_threshold_2_unintended_diff_only": 0.0008499860763549804,
      "tpp_threshold_5_total_metric": 0.0075999915599823,
      "tpp_threshold_5_intended_diff_only": 0.008999979496002198,
      "tpp_threshold_5_unintended_diff_only": 0.0013999879360198975,
      "tpp_threshold_10_total_metric": 0.014599993824958801,
      "tpp_threshold_10_intended_diff_only": 0.01679997444152832,
      "tpp_threshold_10_unintended_diff_only": 0.002199980616569519,
      "tpp_threshold_20_total_metric": 0.05095001757144928,
      "tpp_threshold_20_intended_diff_only": 0.05540000200271607,
      "tpp_threshold_20_unintended_diff_only": 0.004449984431266785,
      "tpp_threshold_50_total_metric": 0.17370002269744872,
      "tpp_threshold_50_intended_diff_only": 0.18440001010894774,
      "tpp_threshold_50_unintended_diff_only": 0.010699987411499023,
      "tpp_threshold_100_total_metric": 0.34020000994205474,
      "tpp_threshold_100_intended_diff_only": 0.3575999975204468,
      "tpp_threshold_100_unintended_diff_only": 0.017399987578392027,
      "tpp_threshold_500_total_metric": 0.4354000449180603,
      "tpp_threshold_500_intended_diff_only": 0.4680000305175781,
      "tpp_threshold_500_unintended_diff_only": 0.03259998559951782
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0010000079870223998,
      "tpp_threshold_2_intended_diff_only": 0.0024000167846679687,
      "tpp_threshold_2_unintended_diff_only": 0.0014000087976455688,
      "tpp_threshold_5_total_metric": 0.005900001525878907,
      "tpp_threshold_5_intended_diff_only": 0.007000005245208741,
      "tpp_threshold_5_unintended_diff_only": 0.001100003719329834,
      "tpp_threshold_10_total_metric": 0.02424999475479126,
      "tpp_threshold_10_intended_diff_only": 0.026999998092651366,
      "tpp_threshold_10_unintended_diff_only": 0.0027500033378601075,
      "tpp_threshold_20_total_metric": 0.06599999368190765,
      "tpp_threshold_20_intended_diff_only": 0.07039999961853027,
      "tpp_threshold_20_unintended_diff_only": 0.00440000593662262,
      "tpp_threshold_50_total_metric": 0.17770000994205476,
      "tpp_threshold_50_intended_diff_only": 0.18340001106262208,
      "tpp_threshold_50_unintended_diff_only": 0.005700001120567321,
      "tpp_threshold_100_total_metric": 0.2923500180244446,
      "tpp_threshold_100_intended_diff_only": 0.305400025844574,
      "tpp_threshold_100_unintended_diff_only": 0.013050007820129394,
      "tpp_threshold_500_total_metric": 0.38880003392696383,
      "tpp_threshold_500_intended_diff_only": 0.4194000482559204,
      "tpp_threshold_500_unintended_diff_only": 0.030600014328956603
    }
  ],
  "sae_bench_commit_hash": "a62015fa6d4f4e93e25cfeaafc350eef7b2ab273",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_batch_topk",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_batch_topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0004999935626983643,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.0014999806880950928,
        "tpp_threshold_5_total_metric": -0.0017500072717666626,
        "tpp_threshold_5_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": 0.0037499815225601196,
        "tpp_threshold_10_total_metric": -0.000250011682510376,
        "tpp_threshold_10_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_10_unintended_diff_only": 0.0032499730587005615,
        "tpp_threshold_20_total_metric": 0.019749999046325684,
        "tpp_threshold_20_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_20_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_50_total_metric": 0.11500002443790436,
        "tpp_threshold_50_intended_diff_only": 0.12400001287460327,
        "tpp_threshold_50_unintended_diff_only": 0.008999988436698914,
        "tpp_threshold_100_total_metric": 0.3334999978542328,
        "tpp_threshold_100_intended_diff_only": 0.3479999899864197,
        "tpp_threshold_100_unintended_diff_only": 0.01449999213218689,
        "tpp_threshold_500_total_metric": 0.42625004053115845,
        "tpp_threshold_500_intended_diff_only": 0.44700002670288086,
        "tpp_threshold_500_unintended_diff_only": 0.020749986171722412
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0012499988079071045,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": -0.000250011682510376,
        "tpp_threshold_5_total_metric": 0.0045000165700912476,
        "tpp_threshold_5_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": 0.0004999786615371704,
        "tpp_threshold_10_total_metric": 0.014249995350837708,
        "tpp_threshold_10_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_10_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_20_total_metric": 0.06850001215934753,
        "tpp_threshold_20_intended_diff_only": 0.07899999618530273,
        "tpp_threshold_20_unintended_diff_only": 0.0104999840259552,
        "tpp_threshold_50_total_metric": 0.2992500215768814,
        "tpp_threshold_50_intended_diff_only": 0.3190000057220459,
        "tpp_threshold_50_unintended_diff_only": 0.01974998414516449,
        "tpp_threshold_100_total_metric": 0.42099998891353607,
        "tpp_threshold_100_intended_diff_only": 0.44599997997283936,
        "tpp_threshold_100_unintended_diff_only": 0.024999991059303284,
        "tpp_threshold_500_total_metric": 0.42075005173683167,
        "tpp_threshold_500_intended_diff_only": 0.4650000333786011,
        "tpp_threshold_500_unintended_diff_only": 0.04424998164176941
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.008999988436698914,
        "tpp_threshold_2_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_2_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_5_total_metric": 0.02225002646446228,
        "tpp_threshold_5_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_5_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_10_total_metric": 0.04549999535083771,
        "tpp_threshold_10_intended_diff_only": 0.04799997806549072,
        "tpp_threshold_10_unintended_diff_only": 0.002499982714653015,
        "tpp_threshold_20_total_metric": 0.11800004541873932,
        "tpp_threshold_20_intended_diff_only": 0.12300002574920654,
        "tpp_threshold_20_unintended_diff_only": 0.004999980330467224,
        "tpp_threshold_50_total_metric": 0.2420000433921814,
        "tpp_threshold_50_intended_diff_only": 0.25200003385543823,
        "tpp_threshold_50_unintended_diff_only": 0.009999990463256836,
        "tpp_threshold_100_total_metric": 0.3765000104904175,
        "tpp_threshold_100_intended_diff_only": 0.39800000190734863,
        "tpp_threshold_100_unintended_diff_only": 0.021499991416931152,
        "tpp_threshold_500_total_metric": 0.418500080704689,
        "tpp_threshold_500_intended_diff_only": 0.45500004291534424,
        "tpp_threshold_500_unintended_diff_only": 0.03649996221065521
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.006999984383583069,
        "tpp_threshold_2_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_5_total_metric": 0.004749983549118042,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": -0.0017500221729278564,
        "tpp_threshold_10_total_metric": 0.0045000165700912476,
        "tpp_threshold_10_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_unintended_diff_only": 0.0004999786615371704,
        "tpp_threshold_20_total_metric": 0.005750030279159546,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": -0.0017500221729278564,
        "tpp_threshold_50_total_metric": 0.03400002419948578,
        "tpp_threshold_50_intended_diff_only": 0.03700000047683716,
        "tpp_threshold_50_unintended_diff_only": 0.0029999762773513794,
        "tpp_threshold_100_total_metric": 0.16075003147125244,
        "tpp_threshold_100_intended_diff_only": 0.16600000858306885,
        "tpp_threshold_100_unintended_diff_only": 0.005249977111816406,
        "tpp_threshold_500_total_metric": 0.4812500327825546,
        "tpp_threshold_500_intended_diff_only": 0.4930000305175781,
        "tpp_threshold_500_unintended_diff_only": 0.011749997735023499
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.006999969482421875,
        "tpp_threshold_2_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_2_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_total_metric": 0.008249938488006592,
        "tpp_threshold_5_intended_diff_only": 0.008999943733215332,
        "tpp_threshold_5_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_10_total_metric": 0.00899997353553772,
        "tpp_threshold_10_intended_diff_only": 0.012999951839447021,
        "tpp_threshold_10_unintended_diff_only": 0.003999978303909302,
        "tpp_threshold_20_total_metric": 0.042750000953674316,
        "tpp_threshold_20_intended_diff_only": 0.046999990940093994,
        "tpp_threshold_20_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_50_total_metric": 0.1782499998807907,
        "tpp_threshold_50_intended_diff_only": 0.1899999976158142,
        "tpp_threshold_50_unintended_diff_only": 0.011749997735023499,
        "tpp_threshold_100_total_metric": 0.40925002098083496,
        "tpp_threshold_100_intended_diff_only": 0.4300000071525574,
        "tpp_threshold_100_unintended_diff_only": 0.020749986171722412,
        "tpp_threshold_500_total_metric": 0.43025001883506775,
        "tpp_threshold_500_intended_diff_only": 0.48000001907348633,
        "tpp_threshold_500_unintended_diff_only": 0.04975000023841858
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.005750015377998352,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_5_total_metric": -0.008000016212463379,
        "tpp_threshold_5_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_10_total_metric": 0.001999989151954651,
        "tpp_threshold_10_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_20_total_metric": 0.015000015497207642,
        "tpp_threshold_20_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_20_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_50_total_metric": 0.07500004768371582,
        "tpp_threshold_50_intended_diff_only": 0.08000004291534424,
        "tpp_threshold_50_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_100_total_metric": 0.17750005424022675,
        "tpp_threshold_100_intended_diff_only": 0.1860000491142273,
        "tpp_threshold_100_unintended_diff_only": 0.00849999487400055,
        "tpp_threshold_500_total_metric": 0.4110000431537628,
        "tpp_threshold_500_intended_diff_only": 0.4360000491142273,
        "tpp_threshold_500_unintended_diff_only": 0.025000005960464478
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.014000028371810913,
        "tpp_threshold_2_intended_diff_only": 0.01100003719329834,
        "tpp_threshold_2_unintended_diff_only": -0.0029999911785125732,
        "tpp_threshold_5_total_metric": 0.00625002384185791,
        "tpp_threshold_5_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_5_unintended_diff_only": 0.005750000476837158,
        "tpp_threshold_10_total_metric": 0.04149998724460602,
        "tpp_threshold_10_intended_diff_only": 0.046999990940093994,
        "tpp_threshold_10_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_20_total_metric": 0.11674998700618744,
        "tpp_threshold_20_intended_diff_only": 0.12099999189376831,
        "tpp_threshold_20_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_50_total_metric": 0.2835000157356262,
        "tpp_threshold_50_intended_diff_only": 0.29100000858306885,
        "tpp_threshold_50_unintended_diff_only": 0.007499992847442627,
        "tpp_threshold_100_total_metric": 0.3812500238418579,
        "tpp_threshold_100_intended_diff_only": 0.3960000276565552,
        "tpp_threshold_100_unintended_diff_only": 0.014750003814697266,
        "tpp_threshold_500_total_metric": 0.40925005078315735,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.030750006437301636
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.009249985218048096,
        "tpp_threshold_2_intended_diff_only": -0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_5_total_metric": -0.004749983549118042,
        "tpp_threshold_5_intended_diff_only": -0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": -0.0012499988079071045,
        "tpp_threshold_10_total_metric": 0.0017500072717666626,
        "tpp_threshold_10_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_10_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_20_total_metric": 0.004249975085258484,
        "tpp_threshold_20_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_20_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_50_total_metric": 0.1120000034570694,
        "tpp_threshold_50_intended_diff_only": 0.12099999189376831,
        "tpp_threshold_50_unintended_diff_only": 0.008999988436698914,
        "tpp_threshold_100_total_metric": 0.29124999046325684,
        "tpp_threshold_100_intended_diff_only": 0.3050000071525574,
        "tpp_threshold_100_unintended_diff_only": 0.013750016689300537,
        "tpp_threshold_500_total_metric": 0.39500002562999725,
        "tpp_threshold_500_intended_diff_only": 0.42200005054473877,
        "tpp_threshold_500_unintended_diff_only": 0.027000024914741516
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.007249996066093445,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": -0.0032499879598617554,
        "tpp_threshold_5_total_metric": 0.004999995231628418,
        "tpp_threshold_5_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": 0.0,
        "tpp_threshold_10_total_metric": 0.013249978423118591,
        "tpp_threshold_10_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_10_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_20_total_metric": 0.03424997627735138,
        "tpp_threshold_20_intended_diff_only": 0.0339999794960022,
        "tpp_threshold_20_unintended_diff_only": -0.00024999678134918213,
        "tpp_threshold_50_total_metric": 0.16874997317790985,
        "tpp_threshold_50_intended_diff_only": 0.171999990940094,
        "tpp_threshold_50_unintended_diff_only": 0.003250017762184143,
        "tpp_threshold_100_total_metric": 0.2642500102519989,
        "tpp_threshold_100_intended_diff_only": 0.2760000228881836,
        "tpp_threshold_100_unintended_diff_only": 0.011750012636184692,
        "tpp_threshold_500_total_metric": 0.4045000374317169,
        "tpp_threshold_500_intended_diff_only": 0.4270000457763672,
        "tpp_threshold_500_unintended_diff_only": 0.02250000834465027
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.0012499839067459106,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_5_total_metric": 0.030999988317489624,
        "tpp_threshold_5_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_5_unintended_diff_only": -0.0029999911785125732,
        "tpp_threshold_10_total_metric": 0.06275001168251038,
        "tpp_threshold_10_intended_diff_only": 0.06400001049041748,
        "tpp_threshold_10_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_20_total_metric": 0.15975001454353333,
        "tpp_threshold_20_intended_diff_only": 0.16600000858306885,
        "tpp_threshold_20_unintended_diff_only": 0.0062499940395355225,
        "tpp_threshold_50_total_metric": 0.24925000965595245,
        "tpp_threshold_50_intended_diff_only": 0.25300002098083496,
        "tpp_threshold_50_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_100_total_metric": 0.3475000113248825,
        "tpp_threshold_100_intended_diff_only": 0.36400002241134644,
        "tpp_threshold_100_unintended_diff_only": 0.016500011086463928,
        "tpp_threshold_500_total_metric": 0.3242500126361847,
        "tpp_threshold_500_intended_diff_only": 0.3720000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.04775002598762512
      }
    }
  }
}