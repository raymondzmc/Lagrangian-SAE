{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "18ecc8df-da6a-4931-8bcf-3bc6aaa93c5e",
  "datetime_epoch_millis": 1769390303258,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.005725003778934479,
      "tpp_threshold_2_intended_diff_only": 0.006999999284744263,
      "tpp_threshold_2_unintended_diff_only": 0.001274995505809784,
      "tpp_threshold_5_total_metric": 0.00530000776052475,
      "tpp_threshold_5_intended_diff_only": 0.0073000013828277595,
      "tpp_threshold_5_unintended_diff_only": 0.001999993622303009,
      "tpp_threshold_10_total_metric": 0.012749995291233062,
      "tpp_threshold_10_intended_diff_only": 0.01739999055862427,
      "tpp_threshold_10_unintended_diff_only": 0.004649995267391205,
      "tpp_threshold_20_total_metric": 0.023949998617172244,
      "tpp_threshold_20_intended_diff_only": 0.02919999361038208,
      "tpp_threshold_20_unintended_diff_only": 0.005249994993209839,
      "tpp_threshold_50_total_metric": 0.045425000786781314,
      "tpp_threshold_50_intended_diff_only": 0.05079999566078186,
      "tpp_threshold_50_unintended_diff_only": 0.005374994874000549,
      "tpp_threshold_100_total_metric": 0.07237500697374344,
      "tpp_threshold_100_intended_diff_only": 0.08130000233650209,
      "tpp_threshold_100_unintended_diff_only": 0.008924995362758637,
      "tpp_threshold_500_total_metric": 0.1236750140786171,
      "tpp_threshold_500_intended_diff_only": 0.13550000786781313,
      "tpp_threshold_500_unintended_diff_only": 0.011824993789196013
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.005500000715255737,
      "tpp_threshold_2_intended_diff_only": 0.006399989128112793,
      "tpp_threshold_2_unintended_diff_only": 0.0008999884128570556,
      "tpp_threshold_5_total_metric": 0.004700016975402832,
      "tpp_threshold_5_intended_diff_only": 0.005999994277954101,
      "tpp_threshold_5_unintended_diff_only": 0.0012999773025512695,
      "tpp_threshold_10_total_metric": 0.008149996399879456,
      "tpp_threshold_10_intended_diff_only": 0.01119997501373291,
      "tpp_threshold_10_unintended_diff_only": 0.0030499786138534547,
      "tpp_threshold_20_total_metric": 0.02240000069141388,
      "tpp_threshold_20_intended_diff_only": 0.025399982929229736,
      "tpp_threshold_20_unintended_diff_only": 0.002999982237815857,
      "tpp_threshold_50_total_metric": 0.03469999134540558,
      "tpp_threshold_50_intended_diff_only": 0.038999974727630615,
      "tpp_threshold_50_unintended_diff_only": 0.004299983382225037,
      "tpp_threshold_100_total_metric": 0.05639999210834503,
      "tpp_threshold_100_intended_diff_only": 0.06099997758865357,
      "tpp_threshold_100_unintended_diff_only": 0.0045999854803085325,
      "tpp_threshold_500_total_metric": 0.09165002405643463,
      "tpp_threshold_500_intended_diff_only": 0.09860000610351563,
      "tpp_threshold_500_unintended_diff_only": 0.006949982047080994
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.00595000684261322,
      "tpp_threshold_2_intended_diff_only": 0.007600009441375732,
      "tpp_threshold_2_unintended_diff_only": 0.0016500025987625123,
      "tpp_threshold_5_total_metric": 0.005899998545646668,
      "tpp_threshold_5_intended_diff_only": 0.008600008487701417,
      "tpp_threshold_5_unintended_diff_only": 0.0027000099420547486,
      "tpp_threshold_10_total_metric": 0.01734999418258667,
      "tpp_threshold_10_intended_diff_only": 0.023600006103515626,
      "tpp_threshold_10_unintended_diff_only": 0.006250011920928955,
      "tpp_threshold_20_total_metric": 0.025499996542930604,
      "tpp_threshold_20_intended_diff_only": 0.03300000429153442,
      "tpp_threshold_20_unintended_diff_only": 0.007500007748603821,
      "tpp_threshold_50_total_metric": 0.05615001022815704,
      "tpp_threshold_50_intended_diff_only": 0.0626000165939331,
      "tpp_threshold_50_unintended_diff_only": 0.006450006365776062,
      "tpp_threshold_100_total_metric": 0.08835002183914184,
      "tpp_threshold_100_intended_diff_only": 0.10160002708435059,
      "tpp_threshold_100_unintended_diff_only": 0.013250005245208741,
      "tpp_threshold_500_total_metric": 0.15570000410079957,
      "tpp_threshold_500_intended_diff_only": 0.1724000096321106,
      "tpp_threshold_500_unintended_diff_only": 0.016700005531311034
    }
  ],
  "sae_bench_commit_hash": "a62015fa6d4f4e93e25cfeaafc350eef7b2ab273",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_topk",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": -0.0012499839067459106,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0012499839067459106,
        "tpp_threshold_5_total_metric": 0.002749994397163391,
        "tpp_threshold_5_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_5_unintended_diff_only": 0.004249975085258484,
        "tpp_threshold_10_total_metric": 0.004749968647956848,
        "tpp_threshold_10_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_10_unintended_diff_only": 0.0032499879598617554,
        "tpp_threshold_20_total_metric": 0.02499997615814209,
        "tpp_threshold_20_intended_diff_only": 0.030999958515167236,
        "tpp_threshold_20_unintended_diff_only": 0.0059999823570251465,
        "tpp_threshold_50_total_metric": 0.038999974727630615,
        "tpp_threshold_50_intended_diff_only": 0.04499995708465576,
        "tpp_threshold_50_unintended_diff_only": 0.0059999823570251465,
        "tpp_threshold_100_total_metric": 0.07449999451637268,
        "tpp_threshold_100_intended_diff_only": 0.08099997043609619,
        "tpp_threshold_100_unintended_diff_only": 0.006499975919723511,
        "tpp_threshold_500_total_metric": 0.11725002527236938,
        "tpp_threshold_500_intended_diff_only": 0.12400001287460327,
        "tpp_threshold_500_unintended_diff_only": 0.006749987602233887
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.004999995231628418,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.0,
        "tpp_threshold_5_total_metric": -0.001499965786933899,
        "tpp_threshold_5_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": 0.0004999786615371704,
        "tpp_threshold_10_total_metric": 0.007500022649765015,
        "tpp_threshold_10_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_10_unintended_diff_only": 0.0024999678134918213,
        "tpp_threshold_20_total_metric": 0.012249991297721863,
        "tpp_threshold_20_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_20_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_50_total_metric": 0.026749998331069946,
        "tpp_threshold_50_intended_diff_only": 0.0339999794960022,
        "tpp_threshold_50_unintended_diff_only": 0.007249981164932251,
        "tpp_threshold_100_total_metric": 0.055749982595443726,
        "tpp_threshold_100_intended_diff_only": 0.06199997663497925,
        "tpp_threshold_100_unintended_diff_only": 0.0062499940395355225,
        "tpp_threshold_500_total_metric": 0.11425000429153442,
        "tpp_threshold_500_intended_diff_only": 0.12099999189376831,
        "tpp_threshold_500_unintended_diff_only": 0.006749987602233887
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.010750025510787964,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_5_total_metric": 0.010750025510787964,
        "tpp_threshold_5_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_5_unintended_diff_only": 0.0032499730587005615,
        "tpp_threshold_10_total_metric": 0.017000004649162292,
        "tpp_threshold_10_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_10_unintended_diff_only": 0.0029999762773513794,
        "tpp_threshold_20_total_metric": 0.03400003910064697,
        "tpp_threshold_20_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_20_unintended_diff_only": 0.001999974250793457,
        "tpp_threshold_50_total_metric": 0.0402500182390213,
        "tpp_threshold_50_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_50_unintended_diff_only": 0.001749977469444275,
        "tpp_threshold_100_total_metric": 0.06474998593330383,
        "tpp_threshold_100_intended_diff_only": 0.06699997186660767,
        "tpp_threshold_100_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_500_total_metric": 0.1207500547170639,
        "tpp_threshold_500_intended_diff_only": 0.12300002574920654,
        "tpp_threshold_500_unintended_diff_only": 0.002249971032142639
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.005750000476837158,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0002499818801879883,
        "tpp_threshold_5_total_metric": 0.0025000274181365967,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": -0.0025000274181365967,
        "tpp_threshold_10_total_metric": 0.0004999786615371704,
        "tpp_threshold_10_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_10_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_20_total_metric": 0.002499997615814209,
        "tpp_threshold_20_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_20_unintended_diff_only": -0.000500023365020752,
        "tpp_threshold_50_total_metric": 0.003000006079673767,
        "tpp_threshold_50_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_50_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_100_total_metric": 0.0015000253915786743,
        "tpp_threshold_100_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_100_unintended_diff_only": 0.002499982714653015,
        "tpp_threshold_500_total_metric": 0.000500023365020752,
        "tpp_threshold_500_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_500_unintended_diff_only": 0.004499971866607666
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.007249966263771057,
        "tpp_threshold_2_intended_diff_only": 0.008999943733215332,
        "tpp_threshold_2_unintended_diff_only": 0.001749977469444275,
        "tpp_threshold_5_total_metric": 0.009000003337860107,
        "tpp_threshold_5_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_5_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_10_total_metric": 0.011000007390975952,
        "tpp_threshold_10_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_10_unintended_diff_only": 0.00499996542930603,
        "tpp_threshold_20_total_metric": 0.03824999928474426,
        "tpp_threshold_20_intended_diff_only": 0.042999982833862305,
        "tpp_threshold_20_unintended_diff_only": 0.004749983549118042,
        "tpp_threshold_50_total_metric": 0.06449995934963226,
        "tpp_threshold_50_intended_diff_only": 0.06899994611740112,
        "tpp_threshold_50_unintended_diff_only": 0.00449998676776886,
        "tpp_threshold_100_total_metric": 0.08549997210502625,
        "tpp_threshold_100_intended_diff_only": 0.09099996089935303,
        "tpp_threshold_100_unintended_diff_only": 0.005499988794326782,
        "tpp_threshold_500_total_metric": 0.10550001263618469,
        "tpp_threshold_500_intended_diff_only": 0.12000000476837158,
        "tpp_threshold_500_unintended_diff_only": 0.01449999213218689
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.007999971508979797,
        "tpp_threshold_2_intended_diff_only": -0.0029999613761901855,
        "tpp_threshold_2_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_5_total_metric": -0.005749955773353577,
        "tpp_threshold_5_intended_diff_only": -0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_10_total_metric": -0.004249945282936096,
        "tpp_threshold_10_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_10_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_20_total_metric": -0.010499954223632812,
        "tpp_threshold_20_intended_diff_only": -0.0029999613761901855,
        "tpp_threshold_20_unintended_diff_only": 0.007499992847442627,
        "tpp_threshold_50_total_metric": 0.010000035166740417,
        "tpp_threshold_50_intended_diff_only": 0.010000050067901611,
        "tpp_threshold_50_unintended_diff_only": 1.4901161193847656e-08,
        "tpp_threshold_100_total_metric": 0.030000045895576477,
        "tpp_threshold_100_intended_diff_only": 0.03800004720687866,
        "tpp_threshold_100_unintended_diff_only": 0.008000001311302185,
        "tpp_threshold_500_total_metric": 0.07074999809265137,
        "tpp_threshold_500_intended_diff_only": 0.078000009059906,
        "tpp_threshold_500_unintended_diff_only": 0.007250010967254639
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.006750032305717468,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": -0.0037500113248825073,
        "tpp_threshold_5_total_metric": -0.0047500282526016235,
        "tpp_threshold_5_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_10_total_metric": 0.0004999935626983643,
        "tpp_threshold_10_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_10_unintended_diff_only": 0.012500017881393433,
        "tpp_threshold_20_total_metric": 0.00824996829032898,
        "tpp_threshold_20_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_20_unintended_diff_only": 0.006750017404556274,
        "tpp_threshold_50_total_metric": 0.015499994158744812,
        "tpp_threshold_50_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_50_unintended_diff_only": 0.016500011086463928,
        "tpp_threshold_100_total_metric": 0.0390000194311142,
        "tpp_threshold_100_intended_diff_only": 0.058000028133392334,
        "tpp_threshold_100_unintended_diff_only": 0.019000008702278137,
        "tpp_threshold_500_total_metric": 0.0987500250339508,
        "tpp_threshold_500_intended_diff_only": 0.11500000953674316,
        "tpp_threshold_500_unintended_diff_only": 0.01624998450279236
      },
      "3": {
        "tpp_threshold_2_total_metric": 0.004999980330467224,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_5_total_metric": 0.0034999698400497437,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_10_total_metric": 0.02399998903274536,
        "tpp_threshold_10_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_10_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_total_metric": 0.02449999749660492,
        "tpp_threshold_20_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_20_unintended_diff_only": 0.01150001585483551,
        "tpp_threshold_50_total_metric": 0.06825001537799835,
        "tpp_threshold_50_intended_diff_only": 0.07300001382827759,
        "tpp_threshold_50_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_100_total_metric": 0.10300002992153168,
        "tpp_threshold_100_intended_diff_only": 0.11300003528594971,
        "tpp_threshold_100_unintended_diff_only": 0.01000000536441803,
        "tpp_threshold_500_total_metric": 0.1850000023841858,
        "tpp_threshold_500_intended_diff_only": 0.203000009059906,
        "tpp_threshold_500_unintended_diff_only": 0.018000006675720215
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.006500020623207092,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": -0.002500012516975403,
        "tpp_threshold_5_total_metric": 0.003250017762184143,
        "tpp_threshold_5_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_5_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_10_total_metric": 0.009999945759773254,
        "tpp_threshold_10_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_10_unintended_diff_only": 0.006000027060508728,
        "tpp_threshold_20_total_metric": 0.01924997568130493,
        "tpp_threshold_20_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_20_unintended_diff_only": 0.005750000476837158,
        "tpp_threshold_50_total_metric": 0.0547499805688858,
        "tpp_threshold_50_intended_diff_only": 0.06099998950958252,
        "tpp_threshold_50_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_100_total_metric": 0.08475001156330109,
        "tpp_threshold_100_intended_diff_only": 0.09600001573562622,
        "tpp_threshold_100_unintended_diff_only": 0.011250004172325134,
        "tpp_threshold_500_total_metric": 0.1380000114440918,
        "tpp_threshold_500_intended_diff_only": 0.1510000228881836,
        "tpp_threshold_500_unintended_diff_only": 0.013000011444091797
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.019499972462654114,
        "tpp_threshold_2_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_2_unintended_diff_only": 0.0045000165700912476,
        "tpp_threshold_5_total_metric": 0.03324998915195465,
        "tpp_threshold_5_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_5_unintended_diff_only": -0.0012499839067459106,
        "tpp_threshold_10_total_metric": 0.056499987840652466,
        "tpp_threshold_10_intended_diff_only": 0.06000000238418579,
        "tpp_threshold_10_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_20_total_metric": 0.085999995470047,
        "tpp_threshold_20_intended_diff_only": 0.09200000762939453,
        "tpp_threshold_20_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_50_total_metric": 0.13225002586841583,
        "tpp_threshold_50_intended_diff_only": 0.13700002431869507,
        "tpp_threshold_50_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_100_total_metric": 0.1850000023841858,
        "tpp_threshold_100_intended_diff_only": 0.203000009059906,
        "tpp_threshold_100_unintended_diff_only": 0.018000006675720215,
        "tpp_threshold_500_total_metric": 0.28599998354911804,
        "tpp_threshold_500_intended_diff_only": 0.3149999976158142,
        "tpp_threshold_500_unintended_diff_only": 0.029000014066696167
      }
    }
  }
}