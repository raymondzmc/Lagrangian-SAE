{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "a3460ee1-8c94-4629-82bf-4dc979d08010",
  "datetime_epoch_millis": 1769390673466,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": -0.000374990701675415,
      "tpp_threshold_2_intended_diff_only": 5.9604644775607465e-09,
      "tpp_threshold_2_unintended_diff_only": 0.00037499666213989256,
      "tpp_threshold_5_total_metric": -0.003150010108947754,
      "tpp_threshold_5_intended_diff_only": -0.0030000150203704835,
      "tpp_threshold_5_unintended_diff_only": 0.0001499950885772705,
      "tpp_threshold_10_total_metric": 0.003374996781349182,
      "tpp_threshold_10_intended_diff_only": 0.0039999961853027345,
      "tpp_threshold_10_unintended_diff_only": 0.0006249994039535522,
      "tpp_threshold_20_total_metric": 0.0010500088334083556,
      "tpp_threshold_20_intended_diff_only": 0.0013000011444091798,
      "tpp_threshold_20_unintended_diff_only": 0.00024999231100082393,
      "tpp_threshold_50_total_metric": 0.0014499962329864503,
      "tpp_threshold_50_intended_diff_only": 0.0011999964714050292,
      "tpp_threshold_50_unintended_diff_only": -0.0002499997615814209,
      "tpp_threshold_100_total_metric": -0.002050003409385681,
      "tpp_threshold_100_intended_diff_only": -0.001100003719329834,
      "tpp_threshold_100_unintended_diff_only": 0.0009499996900558472,
      "tpp_threshold_500_total_metric": -0.0005249902606010437,
      "tpp_threshold_500_intended_diff_only": -0.0002999961376190186,
      "tpp_threshold_500_unintended_diff_only": 0.00022499412298202512
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.0011500209569931031,
      "tpp_threshold_2_intended_diff_only": 0.0012000083923339843,
      "tpp_threshold_2_unintended_diff_only": 4.9987435340881346e-05,
      "tpp_threshold_5_total_metric": -0.0006500095129013062,
      "tpp_threshold_5_intended_diff_only": -0.0006000280380249023,
      "tpp_threshold_5_unintended_diff_only": 4.9981474876403806e-05,
      "tpp_threshold_10_total_metric": 0.00015000700950622558,
      "tpp_threshold_10_intended_diff_only": 0.0003999948501586914,
      "tpp_threshold_10_unintended_diff_only": 0.00024998784065246584,
      "tpp_threshold_20_total_metric": 0.003600013256072998,
      "tpp_threshold_20_intended_diff_only": 0.0031999945640563965,
      "tpp_threshold_20_unintended_diff_only": -0.00040001869201660155,
      "tpp_threshold_50_total_metric": 0.002549993991851807,
      "tpp_threshold_50_intended_diff_only": 0.0023999810218811035,
      "tpp_threshold_50_unintended_diff_only": -0.00015001296997070314,
      "tpp_threshold_100_total_metric": -0.0013500183820724487,
      "tpp_threshold_100_intended_diff_only": -0.0010000228881835937,
      "tpp_threshold_100_unintended_diff_only": 0.00034999549388885497,
      "tpp_threshold_500_total_metric": 0.0002000153064727783,
      "tpp_threshold_500_intended_diff_only": -0.0004000067710876465,
      "tpp_threshold_500_unintended_diff_only": -0.0006000220775604248
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": -0.001900002360343933,
      "tpp_threshold_2_intended_diff_only": -0.0011999964714050292,
      "tpp_threshold_2_unintended_diff_only": 0.0007000058889389038,
      "tpp_threshold_5_total_metric": -0.0056500107049942015,
      "tpp_threshold_5_intended_diff_only": -0.0054000020027160645,
      "tpp_threshold_5_unintended_diff_only": 0.0002500087022781372,
      "tpp_threshold_10_total_metric": 0.006599986553192138,
      "tpp_threshold_10_intended_diff_only": 0.0075999975204467775,
      "tpp_threshold_10_unintended_diff_only": 0.0010000109672546388,
      "tpp_threshold_20_total_metric": -0.0014999955892562866,
      "tpp_threshold_20_intended_diff_only": -0.0005999922752380372,
      "tpp_threshold_20_unintended_diff_only": 0.0009000033140182495,
      "tpp_threshold_50_total_metric": 0.00034999847412109375,
      "tpp_threshold_50_intended_diff_only": 1.1920928955078126e-08,
      "tpp_threshold_50_unintended_diff_only": -0.0003499865531921387,
      "tpp_threshold_100_total_metric": -0.0027499884366989137,
      "tpp_threshold_100_intended_diff_only": -0.0011999845504760743,
      "tpp_threshold_100_unintended_diff_only": 0.0015500038862228394,
      "tpp_threshold_500_total_metric": -0.0012499958276748658,
      "tpp_threshold_500_intended_diff_only": -0.00019998550415039061,
      "tpp_threshold_500_unintended_diff_only": 0.001050010323524475
    }
  ],
  "sae_bench_commit_hash": "a62015fa6d4f4e93e25cfeaafc350eef7b2ab273",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_lagrangian",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_lagrangian",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": -0.0002499818801879883,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0002499818801879883,
        "tpp_threshold_5_total_metric": -0.003250032663345337,
        "tpp_threshold_5_intended_diff_only": -0.001000046730041504,
        "tpp_threshold_5_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_10_total_metric": -0.006499975919723511,
        "tpp_threshold_10_intended_diff_only": -0.004999995231628418,
        "tpp_threshold_10_unintended_diff_only": 0.0014999806880950928,
        "tpp_threshold_20_total_metric": -0.004250019788742065,
        "tpp_threshold_20_intended_diff_only": -0.003000020980834961,
        "tpp_threshold_20_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_50_total_metric": -0.006249979138374329,
        "tpp_threshold_50_intended_diff_only": -0.004999995231628418,
        "tpp_threshold_50_unintended_diff_only": 0.0012499839067459106,
        "tpp_threshold_100_total_metric": -0.005500003695487976,
        "tpp_threshold_100_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_100_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_500_total_metric": -0.007249996066093445,
        "tpp_threshold_500_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_500_unintended_diff_only": -0.0007500201463699341
      },
      "1": {
        "tpp_threshold_2_total_metric": -0.00024996697902679443,
        "tpp_threshold_2_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": -0.0007500201463699341,
        "tpp_threshold_5_total_metric": -0.0029999911785125732,
        "tpp_threshold_5_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": -0.0010000169277191162,
        "tpp_threshold_10_total_metric": 0.0015000104904174805,
        "tpp_threshold_10_intended_diff_only": 0.0,
        "tpp_threshold_10_unintended_diff_only": -0.0015000104904174805,
        "tpp_threshold_20_total_metric": 0.0010000169277191162,
        "tpp_threshold_20_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_20_unintended_diff_only": -2.9802322387695312e-08,
        "tpp_threshold_50_total_metric": 0.001999974250793457,
        "tpp_threshold_50_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_50_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_100_total_metric": -0.00650005042552948,
        "tpp_threshold_100_intended_diff_only": -0.006000041961669922,
        "tpp_threshold_100_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_500_total_metric": 0.002500012516975403,
        "tpp_threshold_500_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_500_unintended_diff_only": -0.0015000253915786743
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.003500029444694519,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": -0.0005000084638595581,
        "tpp_threshold_5_total_metric": 0.0007499903440475464,
        "tpp_threshold_5_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": 0.0012499839067459106,
        "tpp_threshold_10_total_metric": 0.008250012993812561,
        "tpp_threshold_10_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_10_unintended_diff_only": -0.00024999678134918213,
        "tpp_threshold_20_total_metric": 0.01850004494190216,
        "tpp_threshold_20_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_20_unintended_diff_only": -0.0015000253915786743,
        "tpp_threshold_50_total_metric": 0.008000001311302185,
        "tpp_threshold_50_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_50_unintended_diff_only": -0.0020000189542770386,
        "tpp_threshold_100_total_metric": 0.004499971866607666,
        "tpp_threshold_100_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_100_unintended_diff_only": -0.002499997615814209,
        "tpp_threshold_500_total_metric": 0.006750047206878662,
        "tpp_threshold_500_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_500_unintended_diff_only": -0.003750026226043701
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.004250019788742065,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": -0.000250011682510376,
        "tpp_threshold_5_total_metric": 0.00024999678134918213,
        "tpp_threshold_5_intended_diff_only": -0.0020000338554382324,
        "tpp_threshold_5_unintended_diff_only": -0.0022500306367874146,
        "tpp_threshold_10_total_metric": 0.0017500072717666626,
        "tpp_threshold_10_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_10_unintended_diff_only": -0.0007500201463699341,
        "tpp_threshold_20_total_metric": 0.002750024199485779,
        "tpp_threshold_20_intended_diff_only": 0.0,
        "tpp_threshold_20_unintended_diff_only": -0.002750024199485779,
        "tpp_threshold_50_total_metric": 0.005750015377998352,
        "tpp_threshold_50_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_50_unintended_diff_only": -0.0017500072717666626,
        "tpp_threshold_100_total_metric": 0.0010000020265579224,
        "tpp_threshold_100_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_100_unintended_diff_only": 0.0009999722242355347,
        "tpp_threshold_500_total_metric": 0.0007500052452087402,
        "tpp_threshold_500_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_500_unintended_diff_only": 0.0002499818801879883
      },
      "9": {
        "tpp_threshold_2_total_metric": -0.0014999955892562866,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_5_total_metric": 0.001999989151954651,
        "tpp_threshold_5_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_10_total_metric": -0.004250019788742065,
        "tpp_threshold_10_intended_diff_only": -0.0020000338554382324,
        "tpp_threshold_10_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_20_total_metric": 0.0,
        "tpp_threshold_20_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_20_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_50_total_metric": 0.0032499581575393677,
        "tpp_threshold_50_intended_diff_only": 0.003999948501586914,
        "tpp_threshold_50_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_100_total_metric": -0.000250011682510376,
        "tpp_threshold_100_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_100_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_500_total_metric": -0.0017499923706054688,
        "tpp_threshold_500_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_500_unintended_diff_only": 0.0027499794960021973
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.009749993681907654,
        "tpp_threshold_2_intended_diff_only": -0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_5_total_metric": -0.009499981999397278,
        "tpp_threshold_5_intended_diff_only": -0.006999969482421875,
        "tpp_threshold_5_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_10_total_metric": -0.0045000165700912476,
        "tpp_threshold_10_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_10_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_20_total_metric": -0.00874994695186615,
        "tpp_threshold_20_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_20_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_50_total_metric": -0.006749972701072693,
        "tpp_threshold_50_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_50_unintended_diff_only": -0.0012499839067459106,
        "tpp_threshold_100_total_metric": -0.01024995744228363,
        "tpp_threshold_100_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_100_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_500_total_metric": -0.007499963045120239,
        "tpp_threshold_500_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_500_unintended_diff_only": -0.0004999935626983643
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.0052499920129776,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": -0.004250004887580872,
        "tpp_threshold_5_total_metric": -0.01225002110004425,
        "tpp_threshold_5_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_5_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_10_total_metric": 0.006749987602233887,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_20_total_metric": 1.4901161193847656e-08,
        "tpp_threshold_20_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_20_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_50_total_metric": -0.0012499988079071045,
        "tpp_threshold_50_intended_diff_only": 0.0,
        "tpp_threshold_50_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_100_total_metric": -0.0012499690055847168,
        "tpp_threshold_100_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_100_unintended_diff_only": -0.0007500052452087402,
        "tpp_threshold_500_total_metric": -0.004499971866607666,
        "tpp_threshold_500_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_500_unintended_diff_only": 0.002499997615814209
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.009249985218048096,
        "tpp_threshold_2_intended_diff_only": -0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_5_total_metric": -0.0070000141859054565,
        "tpp_threshold_5_intended_diff_only": -0.009000003337860107,
        "tpp_threshold_5_unintended_diff_only": -0.001999989151954651,
        "tpp_threshold_10_total_metric": 0.0,
        "tpp_threshold_10_intended_diff_only": 0.0,
        "tpp_threshold_10_unintended_diff_only": 0.0,
        "tpp_threshold_20_total_metric": -0.012750029563903809,
        "tpp_threshold_20_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_20_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_50_total_metric": -0.0022500306367874146,
        "tpp_threshold_50_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_50_unintended_diff_only": -0.001749977469444275,
        "tpp_threshold_100_total_metric": 0.0017500072717666626,
        "tpp_threshold_100_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_100_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_500_total_metric": -0.0047500282526016235,
        "tpp_threshold_500_intended_diff_only": 0.0,
        "tpp_threshold_500_unintended_diff_only": 0.0047500282526016235
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.008749976754188538,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": -0.0037499815225601196,
        "tpp_threshold_5_total_metric": 0.0007499903440475464,
        "tpp_threshold_5_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_10_total_metric": 0.008249998092651367,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_20_total_metric": 0.004749998450279236,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": -0.0007499903440475464,
        "tpp_threshold_50_total_metric": 0.00449998676776886,
        "tpp_threshold_50_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_50_unintended_diff_only": -0.0004999786615371704,
        "tpp_threshold_100_total_metric": 0.0010000020265579224,
        "tpp_threshold_100_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_100_unintended_diff_only": 0.0020000189542770386,
        "tpp_threshold_500_total_metric": 0.006999984383583069,
        "tpp_threshold_500_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_500_unintended_diff_only": -0.0010000020265579224
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.004500001668930054,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_5_total_metric": -0.0002500265836715698,
        "tpp_threshold_5_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": -0.0037499815225601196,
        "tpp_threshold_10_total_metric": 0.022499963641166687,
        "tpp_threshold_10_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_10_unintended_diff_only": 0.0015000253915786743,
        "tpp_threshold_20_total_metric": 0.009249985218048096,
        "tpp_threshold_20_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_20_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_50_total_metric": 0.007500007748603821,
        "tpp_threshold_50_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_50_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_100_total_metric": -0.005000025033950806,
        "tpp_threshold_100_intended_diff_only": -0.003000020980834961,
        "tpp_threshold_100_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_500_total_metric": 0.0034999996423721313,
        "tpp_threshold_500_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_500_unintended_diff_only": -0.0004999786615371704
      }
    }
  }
}