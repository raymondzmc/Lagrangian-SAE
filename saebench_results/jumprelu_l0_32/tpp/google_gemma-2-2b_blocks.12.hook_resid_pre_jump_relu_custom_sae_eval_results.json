{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "26daf58c-4c6e-4ba6-823d-2a919b9ea807",
  "datetime_epoch_millis": 1769329622696,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0029249966144561765,
      "tpp_threshold_2_intended_diff_only": 0.004099994897842407,
      "tpp_threshold_2_unintended_diff_only": 0.0011749982833862305,
      "tpp_threshold_5_total_metric": 0.006724996864795685,
      "tpp_threshold_5_intended_diff_only": 0.00769999623298645,
      "tpp_threshold_5_unintended_diff_only": 0.0009749993681907654,
      "tpp_threshold_10_total_metric": 0.015125006437301636,
      "tpp_threshold_10_intended_diff_only": 0.016699999570846558,
      "tpp_threshold_10_unintended_diff_only": 0.0015749931335449219,
      "tpp_threshold_20_total_metric": 0.056425003707408904,
      "tpp_threshold_20_intended_diff_only": 0.08529999852180481,
      "tpp_threshold_20_unintended_diff_only": 0.028874994814395906,
      "tpp_threshold_50_total_metric": 0.12107501477003098,
      "tpp_threshold_50_intended_diff_only": 0.16600000858306885,
      "tpp_threshold_50_unintended_diff_only": 0.04492499381303787,
      "tpp_threshold_100_total_metric": 0.1809000089764595,
      "tpp_threshold_100_intended_diff_only": 0.2252000093460083,
      "tpp_threshold_100_unintended_diff_only": 0.0443000003695488,
      "tpp_threshold_500_total_metric": 0.25245001167058945,
      "tpp_threshold_500_intended_diff_only": 0.35350000858306885,
      "tpp_threshold_500_unintended_diff_only": 0.1010499969124794
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.004299992322921753,
      "tpp_threshold_2_intended_diff_only": 0.005399978160858155,
      "tpp_threshold_2_unintended_diff_only": 0.0010999858379364014,
      "tpp_threshold_5_total_metric": 0.006399995088577271,
      "tpp_threshold_5_intended_diff_only": 0.007199978828430176,
      "tpp_threshold_5_unintended_diff_only": 0.0007999837398529053,
      "tpp_threshold_10_total_metric": 0.008300024271011352,
      "tpp_threshold_10_intended_diff_only": 0.009800004959106445,
      "tpp_threshold_10_unintended_diff_only": 0.0014999806880950928,
      "tpp_threshold_20_total_metric": 0.06435000598430633,
      "tpp_threshold_20_intended_diff_only": 0.11519999504089355,
      "tpp_threshold_20_unintended_diff_only": 0.05084998905658722,
      "tpp_threshold_50_total_metric": 0.11455000936985016,
      "tpp_threshold_50_intended_diff_only": 0.1625999927520752,
      "tpp_threshold_50_unintended_diff_only": 0.048049983382225034,
      "tpp_threshold_100_total_metric": 0.21380000114440917,
      "tpp_threshold_100_intended_diff_only": 0.2581999897956848,
      "tpp_threshold_100_unintended_diff_only": 0.04439998865127563,
      "tpp_threshold_500_total_metric": 0.2791500061750412,
      "tpp_threshold_500_intended_diff_only": 0.3579999923706055,
      "tpp_threshold_500_unintended_diff_only": 0.07884998619556427
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0015500009059906006,
      "tpp_threshold_2_intended_diff_only": 0.0028000116348266602,
      "tpp_threshold_2_unintended_diff_only": 0.0012500107288360596,
      "tpp_threshold_5_total_metric": 0.0070499986410140995,
      "tpp_threshold_5_intended_diff_only": 0.008200013637542724,
      "tpp_threshold_5_unintended_diff_only": 0.0011500149965286254,
      "tpp_threshold_10_total_metric": 0.02194998860359192,
      "tpp_threshold_10_intended_diff_only": 0.02359999418258667,
      "tpp_threshold_10_unintended_diff_only": 0.001650005578994751,
      "tpp_threshold_20_total_metric": 0.048500001430511475,
      "tpp_threshold_20_intended_diff_only": 0.05540000200271607,
      "tpp_threshold_20_unintended_diff_only": 0.00690000057220459,
      "tpp_threshold_50_total_metric": 0.1276000201702118,
      "tpp_threshold_50_intended_diff_only": 0.1694000244140625,
      "tpp_threshold_50_unintended_diff_only": 0.041800004243850705,
      "tpp_threshold_100_total_metric": 0.14800001680850983,
      "tpp_threshold_100_intended_diff_only": 0.19220002889633178,
      "tpp_threshold_100_unintended_diff_only": 0.04420001208782196,
      "tpp_threshold_500_total_metric": 0.22575001716613768,
      "tpp_threshold_500_intended_diff_only": 0.3490000247955322,
      "tpp_threshold_500_unintended_diff_only": 0.12325000762939453
    }
  ],
  "sae_bench_commit_hash": "49a408278084c854a29b369c4c9950f9d954c00e",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_jump_relu",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_jump_relu",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0007499903440475464,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.0012499839067459106,
        "tpp_threshold_5_total_metric": 0.002749994397163391,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.0032499879598617554,
        "tpp_threshold_10_total_metric": 0.002500012516975403,
        "tpp_threshold_10_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_10_unintended_diff_only": 0.0034999698400497437,
        "tpp_threshold_20_total_metric": 0.06024998426437378,
        "tpp_threshold_20_intended_diff_only": 0.08499997854232788,
        "tpp_threshold_20_unintended_diff_only": 0.0247499942779541,
        "tpp_threshold_50_total_metric": 0.08150002360343933,
        "tpp_threshold_50_intended_diff_only": 0.11000001430511475,
        "tpp_threshold_50_unintended_diff_only": 0.028499990701675415,
        "tpp_threshold_100_total_metric": 0.20274999737739563,
        "tpp_threshold_100_intended_diff_only": 0.22299998998641968,
        "tpp_threshold_100_unintended_diff_only": 0.020249992609024048,
        "tpp_threshold_500_total_metric": 0.3825000077486038,
        "tpp_threshold_500_intended_diff_only": 0.39899998903274536,
        "tpp_threshold_500_unintended_diff_only": 0.01649998128414154
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0017500072717666626,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": -0.0007500201463699341,
        "tpp_threshold_5_total_metric": 0.0032499730587005615,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": -0.000250011682510376,
        "tpp_threshold_10_total_metric": 0.008250042796134949,
        "tpp_threshold_10_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_10_unintended_diff_only": -0.0002500265836715698,
        "tpp_threshold_20_total_metric": 0.026250004768371582,
        "tpp_threshold_20_intended_diff_only": 0.09799998998641968,
        "tpp_threshold_20_unintended_diff_only": 0.0717499852180481,
        "tpp_threshold_50_total_metric": 0.1770000159740448,
        "tpp_threshold_50_intended_diff_only": 0.21399998664855957,
        "tpp_threshold_50_unintended_diff_only": 0.03699997067451477,
        "tpp_threshold_100_total_metric": 0.2369999885559082,
        "tpp_threshold_100_intended_diff_only": 0.2749999761581421,
        "tpp_threshold_100_unintended_diff_only": 0.03799998760223389,
        "tpp_threshold_500_total_metric": 0.3267499953508377,
        "tpp_threshold_500_intended_diff_only": 0.38499999046325684,
        "tpp_threshold_500_unintended_diff_only": 0.05824999511241913
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.013499975204467773,
        "tpp_threshold_2_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_2_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_5_total_metric": 0.01724998652935028,
        "tpp_threshold_5_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_5_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_10_total_metric": 0.02375003695487976,
        "tpp_threshold_10_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_10_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_20_total_metric": 0.20525003969669342,
        "tpp_threshold_20_intended_diff_only": 0.3630000352859497,
        "tpp_threshold_20_unintended_diff_only": 0.1577499955892563,
        "tpp_threshold_50_total_metric": 0.23900005221366882,
        "tpp_threshold_50_intended_diff_only": 0.4100000262260437,
        "tpp_threshold_50_unintended_diff_only": 0.17099997401237488,
        "tpp_threshold_100_total_metric": 0.3137500137090683,
        "tpp_threshold_100_intended_diff_only": 0.4440000057220459,
        "tpp_threshold_100_unintended_diff_only": 0.1302499920129776,
        "tpp_threshold_500_total_metric": 0.3070000112056732,
        "tpp_threshold_500_intended_diff_only": 0.45399999618530273,
        "tpp_threshold_500_unintended_diff_only": 0.14699998497962952
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.00599999725818634,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_5_total_metric": 0.003500014543533325,
        "tpp_threshold_5_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": -0.0025000274181365967,
        "tpp_threshold_10_total_metric": 0.005250021815299988,
        "tpp_threshold_10_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_10_unintended_diff_only": -0.0012500137090682983,
        "tpp_threshold_20_total_metric": 0.006750032305717468,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": -0.002750024199485779,
        "tpp_threshold_50_total_metric": 0.00899997353553772,
        "tpp_threshold_50_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_50_unintended_diff_only": -0.0010000169277191162,
        "tpp_threshold_100_total_metric": 0.01750001311302185,
        "tpp_threshold_100_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_100_unintended_diff_only": 0.0014999806880950928,
        "tpp_threshold_500_total_metric": 0.09150001406669617,
        "tpp_threshold_500_intended_diff_only": 0.09700000286102295,
        "tpp_threshold_500_unintended_diff_only": 0.005499988794326782
      },
      "9": {
        "tpp_threshold_2_total_metric": -0.0005000084638595581,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.002499982714653015,
        "tpp_threshold_5_total_metric": 0.005250006914138794,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.0007499754428863525,
        "tpp_threshold_10_total_metric": 0.0017500072717666626,
        "tpp_threshold_10_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_unintended_diff_only": 0.0032499879598617554,
        "tpp_threshold_20_total_metric": 0.023249968886375427,
        "tpp_threshold_20_intended_diff_only": 0.02599996328353882,
        "tpp_threshold_20_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_50_total_metric": 0.06624998152256012,
        "tpp_threshold_50_intended_diff_only": 0.07099997997283936,
        "tpp_threshold_50_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_100_total_metric": 0.2979999929666519,
        "tpp_threshold_100_intended_diff_only": 0.32999998331069946,
        "tpp_threshold_100_unintended_diff_only": 0.031999990344047546,
        "tpp_threshold_500_total_metric": 0.2880000025033951,
        "tpp_threshold_500_intended_diff_only": 0.45499998331069946,
        "tpp_threshold_500_unintended_diff_only": 0.16699998080730438
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.004499971866607666,
        "tpp_threshold_2_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_2_unintended_diff_only": 0.00550001859664917,
        "tpp_threshold_5_total_metric": -0.005749985575675964,
        "tpp_threshold_5_intended_diff_only": -0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": 0.002750024199485779,
        "tpp_threshold_10_total_metric": 0.004500031471252441,
        "tpp_threshold_10_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_10_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_20_total_metric": -0.0010000020265579224,
        "tpp_threshold_20_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_20_unintended_diff_only": 0.00599999725818634,
        "tpp_threshold_50_total_metric": 0.027250051498413086,
        "tpp_threshold_50_intended_diff_only": 0.029000043869018555,
        "tpp_threshold_50_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_100_total_metric": 0.0520000159740448,
        "tpp_threshold_100_intended_diff_only": 0.058000028133392334,
        "tpp_threshold_100_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_500_total_metric": 0.15900000929832458,
        "tpp_threshold_500_intended_diff_only": 0.16200000047683716,
        "tpp_threshold_500_unintended_diff_only": 0.0029999911785125732
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.012500002980232239,
        "tpp_threshold_2_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_2_unintended_diff_only": -0.00449998676776886,
        "tpp_threshold_5_total_metric": 0.007750004529953003,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": 0.005250006914138794,
        "tpp_threshold_10_total_metric": 0.030999988317489624,
        "tpp_threshold_10_intended_diff_only": 0.03299999237060547,
        "tpp_threshold_10_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_20_total_metric": 0.02350001037120819,
        "tpp_threshold_20_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_20_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_50_total_metric": 0.046249985694885254,
        "tpp_threshold_50_intended_diff_only": 0.05199998617172241,
        "tpp_threshold_50_unintended_diff_only": 0.005750000476837158,
        "tpp_threshold_100_total_metric": 0.06525002419948578,
        "tpp_threshold_100_intended_diff_only": 0.07600003480911255,
        "tpp_threshold_100_unintended_diff_only": 0.01075001060962677,
        "tpp_threshold_500_total_metric": 0.16875000298023224,
        "tpp_threshold_500_intended_diff_only": 0.3880000114440918,
        "tpp_threshold_500_unintended_diff_only": 0.21925000846385956
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.006500020623207092,
        "tpp_threshold_2_intended_diff_only": -0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_5_total_metric": -0.0012499839067459106,
        "tpp_threshold_5_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": -0.0007499903440475464,
        "tpp_threshold_10_total_metric": 0.011499956250190735,
        "tpp_threshold_10_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_10_unintended_diff_only": -0.0004999786615371704,
        "tpp_threshold_20_total_metric": -0.000250011682510376,
        "tpp_threshold_20_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_20_unintended_diff_only": 0.0062499940395355225,
        "tpp_threshold_50_total_metric": 0.24675004184246063,
        "tpp_threshold_50_intended_diff_only": 0.42200005054473877,
        "tpp_threshold_50_unintended_diff_only": 0.17525000870227814,
        "tpp_threshold_100_total_metric": 0.24925003945827484,
        "tpp_threshold_100_intended_diff_only": 0.42200005054473877,
        "tpp_threshold_100_unintended_diff_only": 0.17275001108646393,
        "tpp_threshold_500_total_metric": 0.24225002527236938,
        "tpp_threshold_500_intended_diff_only": 0.42200005054473877,
        "tpp_threshold_500_unintended_diff_only": 0.17975002527236938
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.007999986410140991,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": -0.0029999911785125732,
        "tpp_threshold_5_total_metric": 0.012749984860420227,
        "tpp_threshold_5_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_5_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_10_total_metric": 0.016499996185302734,
        "tpp_threshold_10_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_10_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_20_total_metric": 0.014749974012374878,
        "tpp_threshold_20_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_20_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_50_total_metric": 0.03225000202655792,
        "tpp_threshold_50_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_50_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_100_total_metric": 0.05750000476837158,
        "tpp_threshold_100_intended_diff_only": 0.06400001049041748,
        "tpp_threshold_100_unintended_diff_only": 0.0065000057220458984,
        "tpp_threshold_500_total_metric": 0.2645000070333481,
        "tpp_threshold_500_intended_diff_only": 0.4010000228881836,
        "tpp_threshold_500_unintended_diff_only": 0.1365000158548355
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.0017499923706054688,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_5_total_metric": 0.02174997329711914,
        "tpp_threshold_5_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_5_unintended_diff_only": -0.0027499794960021973,
        "tpp_threshold_10_total_metric": 0.04624997079372406,
        "tpp_threshold_10_intended_diff_only": 0.04799997806549072,
        "tpp_threshold_10_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_20_total_metric": 0.2055000364780426,
        "tpp_threshold_20_intended_diff_only": 0.22400003671646118,
        "tpp_threshold_20_unintended_diff_only": 0.01850000023841858,
        "tpp_threshold_50_total_metric": 0.28550001978874207,
        "tpp_threshold_50_intended_diff_only": 0.30800002813339233,
        "tpp_threshold_50_unintended_diff_only": 0.02250000834465027,
        "tpp_threshold_100_total_metric": 0.31599999964237213,
        "tpp_threshold_100_intended_diff_only": 0.3410000205039978,
        "tpp_threshold_100_unintended_diff_only": 0.02500002086162567,
        "tpp_threshold_500_total_metric": 0.2942500412464142,
        "tpp_threshold_500_intended_diff_only": 0.3720000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.07774999737739563
      }
    }
  }
}