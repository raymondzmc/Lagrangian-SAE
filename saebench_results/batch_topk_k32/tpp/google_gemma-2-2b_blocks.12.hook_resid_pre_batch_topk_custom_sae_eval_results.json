{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "b1c02387-18b3-4cd5-9891-9817d71f9e83",
  "datetime_epoch_millis": 1769329259267,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0023750051856040954,
      "tpp_threshold_2_intended_diff_only": 0.0037999987602233888,
      "tpp_threshold_2_unintended_diff_only": 0.0014249935746192934,
      "tpp_threshold_5_total_metric": 0.005950002372264862,
      "tpp_threshold_5_intended_diff_only": 0.00769999623298645,
      "tpp_threshold_5_unintended_diff_only": 0.0017499938607215882,
      "tpp_threshold_10_total_metric": 0.015125006437301636,
      "tpp_threshold_10_intended_diff_only": 0.01890000104904175,
      "tpp_threshold_10_unintended_diff_only": 0.0037749946117401124,
      "tpp_threshold_20_total_metric": 0.02657501101493835,
      "tpp_threshold_20_intended_diff_only": 0.03220000267028808,
      "tpp_threshold_20_unintended_diff_only": 0.005624991655349732,
      "tpp_threshold_50_total_metric": 0.06270000338554382,
      "tpp_threshold_50_intended_diff_only": 0.07039999961853027,
      "tpp_threshold_50_unintended_diff_only": 0.00769999623298645,
      "tpp_threshold_100_total_metric": 0.09944998919963838,
      "tpp_threshold_100_intended_diff_only": 0.11189998984336852,
      "tpp_threshold_100_unintended_diff_only": 0.012450000643730162,
      "tpp_threshold_500_total_metric": 0.19717501401901244,
      "tpp_threshold_500_intended_diff_only": 0.21480001211166383,
      "tpp_threshold_500_unintended_diff_only": 0.01762499809265137
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.002799999713897705,
      "tpp_threshold_2_intended_diff_only": 0.00399998426437378,
      "tpp_threshold_2_unintended_diff_only": 0.0011999845504760743,
      "tpp_threshold_5_total_metric": 0.005450010299682617,
      "tpp_threshold_5_intended_diff_only": 0.007399988174438476,
      "tpp_threshold_5_unintended_diff_only": 0.0019499778747558594,
      "tpp_threshold_10_total_metric": 0.012250009179115295,
      "tpp_threshold_10_intended_diff_only": 0.016199994087219238,
      "tpp_threshold_10_unintended_diff_only": 0.003949984908103943,
      "tpp_threshold_20_total_metric": 0.030200010538101195,
      "tpp_threshold_20_intended_diff_only": 0.03579999208450317,
      "tpp_threshold_20_unintended_diff_only": 0.005599981546401978,
      "tpp_threshold_50_total_metric": 0.06325001120567322,
      "tpp_threshold_50_intended_diff_only": 0.07259999513626099,
      "tpp_threshold_50_unintended_diff_only": 0.00934998393058777,
      "tpp_threshold_100_total_metric": 0.10564998388290406,
      "tpp_threshold_100_intended_diff_only": 0.1149999737739563,
      "tpp_threshold_100_unintended_diff_only": 0.009349989891052245,
      "tpp_threshold_500_total_metric": 0.19405001401901245,
      "tpp_threshold_500_intended_diff_only": 0.20900000333786012,
      "tpp_threshold_500_unintended_diff_only": 0.014949989318847657
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0019500106573104858,
      "tpp_threshold_2_intended_diff_only": 0.003600013256072998,
      "tpp_threshold_2_unintended_diff_only": 0.0016500025987625123,
      "tpp_threshold_5_total_metric": 0.006449994444847107,
      "tpp_threshold_5_intended_diff_only": 0.008000004291534423,
      "tpp_threshold_5_unintended_diff_only": 0.0015500098466873168,
      "tpp_threshold_10_total_metric": 0.018000003695487977,
      "tpp_threshold_10_intended_diff_only": 0.021600008010864258,
      "tpp_threshold_10_unintended_diff_only": 0.003600004315376282,
      "tpp_threshold_20_total_metric": 0.022950011491775512,
      "tpp_threshold_20_intended_diff_only": 0.028600013256072997,
      "tpp_threshold_20_unintended_diff_only": 0.0056500017642974855,
      "tpp_threshold_50_total_metric": 0.06214999556541443,
      "tpp_threshold_50_intended_diff_only": 0.06820000410079956,
      "tpp_threshold_50_unintended_diff_only": 0.006050008535385132,
      "tpp_threshold_100_total_metric": 0.09324999451637268,
      "tpp_threshold_100_intended_diff_only": 0.10880000591278076,
      "tpp_threshold_100_unintended_diff_only": 0.01555001139640808,
      "tpp_threshold_500_total_metric": 0.20030001401901246,
      "tpp_threshold_500_intended_diff_only": 0.22060002088546754,
      "tpp_threshold_500_unintended_diff_only": 0.020300006866455077
    }
  ],
  "sae_bench_commit_hash": "49a408278084c854a29b369c4c9950f9d954c00e",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_batch_topk",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_batch_topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0004999935626983643,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.0014999806880950928,
        "tpp_threshold_5_total_metric": 0.0050000399351119995,
        "tpp_threshold_5_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_5_unintended_diff_only": 0.003999963402748108,
        "tpp_threshold_10_total_metric": 0.010499998927116394,
        "tpp_threshold_10_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_10_unintended_diff_only": 0.00449998676776886,
        "tpp_threshold_20_total_metric": 0.024499982595443726,
        "tpp_threshold_20_intended_diff_only": 0.030999958515167236,
        "tpp_threshold_20_unintended_diff_only": 0.006499975919723511,
        "tpp_threshold_50_total_metric": 0.06050002574920654,
        "tpp_threshold_50_intended_diff_only": 0.0690000057220459,
        "tpp_threshold_50_unintended_diff_only": 0.008499979972839355,
        "tpp_threshold_100_total_metric": 0.11224997043609619,
        "tpp_threshold_100_intended_diff_only": 0.12799996137619019,
        "tpp_threshold_100_unintended_diff_only": 0.015749990940093994,
        "tpp_threshold_500_total_metric": 0.2302500307559967,
        "tpp_threshold_500_intended_diff_only": 0.25300002098083496,
        "tpp_threshold_500_unintended_diff_only": 0.022749990224838257
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.003000020980834961,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_total_metric": 0.003999993205070496,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_10_total_metric": 0.017000004649162292,
        "tpp_threshold_10_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_10_unintended_diff_only": 0.006999984383583069,
        "tpp_threshold_20_total_metric": 0.036750033497810364,
        "tpp_threshold_20_intended_diff_only": 0.050000011920928955,
        "tpp_threshold_20_unintended_diff_only": 0.013249978423118591,
        "tpp_threshold_50_total_metric": 0.07325002551078796,
        "tpp_threshold_50_intended_diff_only": 0.0910000205039978,
        "tpp_threshold_50_unintended_diff_only": 0.01774999499320984,
        "tpp_threshold_100_total_metric": 0.15174996852874756,
        "tpp_threshold_100_intended_diff_only": 0.16899996995925903,
        "tpp_threshold_100_unintended_diff_only": 0.017250001430511475,
        "tpp_threshold_500_total_metric": 0.2927500307559967,
        "tpp_threshold_500_intended_diff_only": 0.30900001525878906,
        "tpp_threshold_500_unintended_diff_only": 0.01624998450279236
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.0027499794960021973,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": -0.0007500052452087402,
        "tpp_threshold_5_total_metric": 0.001250043511390686,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": 0.001749977469444275,
        "tpp_threshold_10_total_metric": 0.01225002110004425,
        "tpp_threshold_10_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_10_unintended_diff_only": 0.001749977469444275,
        "tpp_threshold_20_total_metric": 0.025000005960464478,
        "tpp_threshold_20_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_20_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_50_total_metric": 0.033000051975250244,
        "tpp_threshold_50_intended_diff_only": 0.04000002145767212,
        "tpp_threshold_50_unintended_diff_only": 0.006999969482421875,
        "tpp_threshold_100_total_metric": 0.053500011563301086,
        "tpp_threshold_100_intended_diff_only": 0.0559999942779541,
        "tpp_threshold_100_unintended_diff_only": 0.002499982714653015,
        "tpp_threshold_500_total_metric": 0.10899999737739563,
        "tpp_threshold_500_intended_diff_only": 0.12199997901916504,
        "tpp_threshold_500_unintended_diff_only": 0.01299998164176941
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0062499940395355225,
        "tpp_threshold_2_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": 0.0007499754428863525,
        "tpp_threshold_5_total_metric": 0.0052499920129776,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": -0.0022500306367874146,
        "tpp_threshold_10_total_metric": 0.004999995231628418,
        "tpp_threshold_10_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_unintended_diff_only": 0.0,
        "tpp_threshold_20_total_metric": 0.005500033497810364,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": -0.0015000253915786743,
        "tpp_threshold_50_total_metric": 0.002249985933303833,
        "tpp_threshold_50_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_50_unintended_diff_only": 0.004749983549118042,
        "tpp_threshold_100_total_metric": 0.002499982714653015,
        "tpp_threshold_100_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_100_unintended_diff_only": 0.00449998676776886,
        "tpp_threshold_500_total_metric": 0.018500015139579773,
        "tpp_threshold_500_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_500_unintended_diff_only": 0.00849999487400055
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.0015000104904174805,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.0034999847412109375,
        "tpp_threshold_5_total_metric": 0.011749982833862305,
        "tpp_threshold_5_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_5_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_10_total_metric": 0.016500025987625122,
        "tpp_threshold_10_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_10_unintended_diff_only": 0.006499975919723511,
        "tpp_threshold_20_total_metric": 0.05924999713897705,
        "tpp_threshold_20_intended_diff_only": 0.06599998474121094,
        "tpp_threshold_20_unintended_diff_only": 0.006749987602233887,
        "tpp_threshold_50_total_metric": 0.1472499668598175,
        "tpp_threshold_50_intended_diff_only": 0.15599995851516724,
        "tpp_threshold_50_unintended_diff_only": 0.008749991655349731,
        "tpp_threshold_100_total_metric": 0.2082499861717224,
        "tpp_threshold_100_intended_diff_only": 0.2149999737739563,
        "tpp_threshold_100_unintended_diff_only": 0.006749987602233887,
        "tpp_threshold_500_total_metric": 0.31974999606609344,
        "tpp_threshold_500_intended_diff_only": 0.33399999141693115,
        "tpp_threshold_500_unintended_diff_only": 0.014249995350837708
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.0054999589920043945,
        "tpp_threshold_2_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_2_unintended_diff_only": 0.0065000057220458984,
        "tpp_threshold_5_total_metric": -0.004999995231628418,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_total_metric": -0.0034999698400497437,
        "tpp_threshold_10_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_10_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_20_total_metric": -0.0032499730587005615,
        "tpp_threshold_20_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_20_unintended_diff_only": 0.005250006914138794,
        "tpp_threshold_50_total_metric": 0.030000001192092896,
        "tpp_threshold_50_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_50_unintended_diff_only": -0.0020000040531158447,
        "tpp_threshold_100_total_metric": 0.041749998927116394,
        "tpp_threshold_100_intended_diff_only": 0.050000011920928955,
        "tpp_threshold_100_unintended_diff_only": 0.008250012993812561,
        "tpp_threshold_500_total_metric": 0.11375002562999725,
        "tpp_threshold_500_intended_diff_only": 0.11800003051757812,
        "tpp_threshold_500_unintended_diff_only": 0.004250004887580872
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.006500035524368286,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": -0.003500014543533325,
        "tpp_threshold_5_total_metric": 0.00100003182888031,
        "tpp_threshold_5_intended_diff_only": 0.006000041961669922,
        "tpp_threshold_5_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_10_total_metric": 0.013750016689300537,
        "tpp_threshold_10_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_10_unintended_diff_only": 0.007250010967254639,
        "tpp_threshold_20_total_metric": 0.017250001430511475,
        "tpp_threshold_20_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_20_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_50_total_metric": 0.03550003468990326,
        "tpp_threshold_50_intended_diff_only": 0.04300004243850708,
        "tpp_threshold_50_unintended_diff_only": 0.007500007748603821,
        "tpp_threshold_100_total_metric": 0.07000000774860382,
        "tpp_threshold_100_intended_diff_only": 0.08600002527236938,
        "tpp_threshold_100_unintended_diff_only": 0.016000017523765564,
        "tpp_threshold_500_total_metric": 0.15175004303455353,
        "tpp_threshold_500_intended_diff_only": 0.17200005054473877,
        "tpp_threshold_500_unintended_diff_only": 0.02025000751018524
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.00974997878074646,
        "tpp_threshold_2_intended_diff_only": -0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_5_total_metric": -0.000250011682510376,
        "tpp_threshold_5_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": -0.0007499754428863525,
        "tpp_threshold_10_total_metric": 0.009999975562095642,
        "tpp_threshold_10_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_10_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_20_total_metric": 0.041999995708465576,
        "tpp_threshold_20_intended_diff_only": 0.05699998140335083,
        "tpp_threshold_20_unintended_diff_only": 0.014999985694885254,
        "tpp_threshold_50_total_metric": 0.08324997127056122,
        "tpp_threshold_50_intended_diff_only": 0.1029999852180481,
        "tpp_threshold_50_unintended_diff_only": 0.019750013947486877,
        "tpp_threshold_100_total_metric": 0.11024999618530273,
        "tpp_threshold_100_intended_diff_only": 0.14300000667572021,
        "tpp_threshold_100_unintended_diff_only": 0.03275001049041748,
        "tpp_threshold_500_total_metric": 0.22824999690055847,
        "tpp_threshold_500_intended_diff_only": 0.27300000190734863,
        "tpp_threshold_500_unintended_diff_only": 0.04475000500679016
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.011749997735023499,
        "tpp_threshold_2_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": -0.002749994397163391,
        "tpp_threshold_5_total_metric": 0.014499977231025696,
        "tpp_threshold_5_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_5_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_10_total_metric": 0.02425001561641693,
        "tpp_threshold_10_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_10_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_20_total_metric": 0.01975002884864807,
        "tpp_threshold_20_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_20_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_50_total_metric": 0.0769999772310257,
        "tpp_threshold_50_intended_diff_only": 0.07999998331069946,
        "tpp_threshold_50_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_100_total_metric": 0.11124996840953827,
        "tpp_threshold_100_intended_diff_only": 0.12199997901916504,
        "tpp_threshold_100_unintended_diff_only": 0.01075001060962677,
        "tpp_threshold_500_total_metric": 0.18924997746944427,
        "tpp_threshold_500_intended_diff_only": 0.19999998807907104,
        "tpp_threshold_500_unintended_diff_only": 0.01075001060962677
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.006749957799911499,
        "tpp_threshold_2_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_2_unintended_diff_only": 0.004250019788742065,
        "tpp_threshold_5_total_metric": 0.021999970078468323,
        "tpp_threshold_5_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_5_unintended_diff_only": -0.001999989151954651,
        "tpp_threshold_10_total_metric": 0.045499980449676514,
        "tpp_threshold_10_intended_diff_only": 0.04799997806549072,
        "tpp_threshold_10_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_20_total_metric": 0.039000004529953,
        "tpp_threshold_20_intended_diff_only": 0.04100000858306885,
        "tpp_threshold_20_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_50_total_metric": 0.08499999344348907,
        "tpp_threshold_50_intended_diff_only": 0.08700001239776611,
        "tpp_threshold_50_unintended_diff_only": 0.0020000189542770386,
        "tpp_threshold_100_total_metric": 0.13300000131130219,
        "tpp_threshold_100_intended_diff_only": 0.14300000667572021,
        "tpp_threshold_100_unintended_diff_only": 0.01000000536441803,
        "tpp_threshold_500_total_metric": 0.31850002706050873,
        "tpp_threshold_500_intended_diff_only": 0.3400000333786011,
        "tpp_threshold_500_unintended_diff_only": 0.021500006318092346
      }
    }
  }
}