{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "fbd80130-2414-4ff8-9cd2-51b751b51f9d",
  "datetime_epoch_millis": 1769390817865,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.004950003325939178,
      "tpp_threshold_2_intended_diff_only": 0.006699997186660767,
      "tpp_threshold_2_unintended_diff_only": 0.0017499938607215882,
      "tpp_threshold_5_total_metric": 0.0169000118970871,
      "tpp_threshold_5_intended_diff_only": 0.019200003147125243,
      "tpp_threshold_5_unintended_diff_only": 0.002299991250038147,
      "tpp_threshold_10_total_metric": 0.04012500643730164,
      "tpp_threshold_10_intended_diff_only": 0.04399999976158142,
      "tpp_threshold_10_unintended_diff_only": 0.003874993324279785,
      "tpp_threshold_20_total_metric": 0.10579998940229415,
      "tpp_threshold_20_intended_diff_only": 0.11329998970031738,
      "tpp_threshold_20_unintended_diff_only": 0.007500000298023224,
      "tpp_threshold_50_total_metric": 0.2586750164628029,
      "tpp_threshold_50_intended_diff_only": 0.2749000132083893,
      "tpp_threshold_50_unintended_diff_only": 0.016224996745586397,
      "tpp_threshold_100_total_metric": 0.37392502278089523,
      "tpp_threshold_100_intended_diff_only": 0.39800001978874205,
      "tpp_threshold_100_unintended_diff_only": 0.02407499700784683,
      "tpp_threshold_500_total_metric": 0.3907750353217125,
      "tpp_threshold_500_intended_diff_only": 0.4444000363349915,
      "tpp_threshold_500_unintended_diff_only": 0.05362500101327896
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.005550000071525574,
      "tpp_threshold_2_intended_diff_only": 0.0067999839782714845,
      "tpp_threshold_2_unintended_diff_only": 0.0012499839067459106,
      "tpp_threshold_5_total_metric": 0.0119500070810318,
      "tpp_threshold_5_intended_diff_only": 0.013799989223480224,
      "tpp_threshold_5_unintended_diff_only": 0.0018499821424484252,
      "tpp_threshold_10_total_metric": 0.029050010442733764,
      "tpp_threshold_10_intended_diff_only": 0.03299999237060547,
      "tpp_threshold_10_unintended_diff_only": 0.003949981927871704,
      "tpp_threshold_20_total_metric": 0.09939998388290405,
      "tpp_threshold_20_intended_diff_only": 0.10659997463226319,
      "tpp_threshold_20_unintended_diff_only": 0.007199990749359131,
      "tpp_threshold_50_total_metric": 0.2793000161647797,
      "tpp_threshold_50_intended_diff_only": 0.29480000734329226,
      "tpp_threshold_50_unintended_diff_only": 0.015499991178512574,
      "tpp_threshold_100_total_metric": 0.4085000306367874,
      "tpp_threshold_100_intended_diff_only": 0.43020001649856565,
      "tpp_threshold_100_unintended_diff_only": 0.021699985861778258,
      "tpp_threshold_500_total_metric": 0.42410002648830414,
      "tpp_threshold_500_intended_diff_only": 0.4678000211715698,
      "tpp_threshold_500_unintended_diff_only": 0.043699994683265686
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.004350006580352783,
      "tpp_threshold_2_intended_diff_only": 0.006600010395050049,
      "tpp_threshold_2_unintended_diff_only": 0.002250003814697266,
      "tpp_threshold_5_total_metric": 0.021850016713142396,
      "tpp_threshold_5_intended_diff_only": 0.024600017070770263,
      "tpp_threshold_5_unintended_diff_only": 0.0027500003576278686,
      "tpp_threshold_10_total_metric": 0.05120000243186951,
      "tpp_threshold_10_intended_diff_only": 0.05500000715255737,
      "tpp_threshold_10_unintended_diff_only": 0.003800004720687866,
      "tpp_threshold_20_total_metric": 0.11219999492168427,
      "tpp_threshold_20_intended_diff_only": 0.12000000476837158,
      "tpp_threshold_20_unintended_diff_only": 0.007800009846687317,
      "tpp_threshold_50_total_metric": 0.2380500167608261,
      "tpp_threshold_50_intended_diff_only": 0.25500001907348635,
      "tpp_threshold_50_unintended_diff_only": 0.016950002312660216,
      "tpp_threshold_100_total_metric": 0.33935001492500305,
      "tpp_threshold_100_intended_diff_only": 0.36580002307891846,
      "tpp_threshold_100_unintended_diff_only": 0.026450008153915405,
      "tpp_threshold_500_total_metric": 0.3574500441551208,
      "tpp_threshold_500_intended_diff_only": 0.4210000514984131,
      "tpp_threshold_500_unintended_diff_only": 0.06355000734329223
    }
  ],
  "sae_bench_commit_hash": "a62015fa6d4f4e93e25cfeaafc350eef7b2ab273",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_matryoshka",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_matryoshka",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0072500258684158325,
        "tpp_threshold_2_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": 0.001749977469444275,
        "tpp_threshold_5_total_metric": 0.018000006675720215,
        "tpp_threshold_5_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_5_unintended_diff_only": 0.0059999823570251465,
        "tpp_threshold_10_total_metric": 0.028249993920326233,
        "tpp_threshold_10_intended_diff_only": 0.0339999794960022,
        "tpp_threshold_10_unintended_diff_only": 0.005749985575675964,
        "tpp_threshold_20_total_metric": 0.06549996137619019,
        "tpp_threshold_20_intended_diff_only": 0.0769999623298645,
        "tpp_threshold_20_unintended_diff_only": 0.011500000953674316,
        "tpp_threshold_50_total_metric": 0.22450001537799835,
        "tpp_threshold_50_intended_diff_only": 0.23900002241134644,
        "tpp_threshold_50_unintended_diff_only": 0.014500007033348083,
        "tpp_threshold_100_total_metric": 0.3525000363588333,
        "tpp_threshold_100_intended_diff_only": 0.37400001287460327,
        "tpp_threshold_100_unintended_diff_only": 0.02149997651576996,
        "tpp_threshold_500_total_metric": 0.4037500321865082,
        "tpp_threshold_500_intended_diff_only": 0.44700002670288086,
        "tpp_threshold_500_unintended_diff_only": 0.04324999451637268
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.007999986410140991,
        "tpp_threshold_2_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": -0.0010000169277191162,
        "tpp_threshold_5_total_metric": 0.011750027537345886,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": 0.0012499839067459106,
        "tpp_threshold_10_total_metric": 0.0337500125169754,
        "tpp_threshold_10_intended_diff_only": 0.03799998760223389,
        "tpp_threshold_10_unintended_diff_only": 0.004249975085258484,
        "tpp_threshold_20_total_metric": 0.17424999177455902,
        "tpp_threshold_20_intended_diff_only": 0.18599998950958252,
        "tpp_threshold_20_unintended_diff_only": 0.011749997735023499,
        "tpp_threshold_50_total_metric": 0.38200002908706665,
        "tpp_threshold_50_intended_diff_only": 0.406000018119812,
        "tpp_threshold_50_unintended_diff_only": 0.02399998903274536,
        "tpp_threshold_100_total_metric": 0.4400000423192978,
        "tpp_threshold_100_intended_diff_only": 0.4650000333786011,
        "tpp_threshold_100_unintended_diff_only": 0.024999991059303284,
        "tpp_threshold_500_total_metric": 0.4110000431537628,
        "tpp_threshold_500_intended_diff_only": 0.4650000333786011,
        "tpp_threshold_500_unintended_diff_only": 0.05399999022483826
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.006000027060508728,
        "tpp_threshold_2_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_2_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_5_total_metric": 0.013750046491622925,
        "tpp_threshold_5_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_5_unintended_diff_only": 0.0032499730587005615,
        "tpp_threshold_10_total_metric": 0.03925001621246338,
        "tpp_threshold_10_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_10_unintended_diff_only": 0.0027499794960021973,
        "tpp_threshold_20_total_metric": 0.14000000059604645,
        "tpp_threshold_20_intended_diff_only": 0.14899998903274536,
        "tpp_threshold_20_unintended_diff_only": 0.008999988436698914,
        "tpp_threshold_50_total_metric": 0.33125002682209015,
        "tpp_threshold_50_intended_diff_only": 0.35100001096725464,
        "tpp_threshold_50_unintended_diff_only": 0.01974998414516449,
        "tpp_threshold_100_total_metric": 0.4150000661611557,
        "tpp_threshold_100_intended_diff_only": 0.4410000443458557,
        "tpp_threshold_100_unintended_diff_only": 0.025999978184700012,
        "tpp_threshold_500_total_metric": 0.4045000523328781,
        "tpp_threshold_500_intended_diff_only": 0.45500004291534424,
        "tpp_threshold_500_unintended_diff_only": 0.050499990582466125
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.00599999725818634,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_5_total_metric": 0.004749983549118042,
        "tpp_threshold_5_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": -0.002750009298324585,
        "tpp_threshold_10_total_metric": 0.009000018239021301,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_20_total_metric": 0.021500006318092346,
        "tpp_threshold_20_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_20_unintended_diff_only": -0.0015000253915786743,
        "tpp_threshold_50_total_metric": 0.0832500010728836,
        "tpp_threshold_50_intended_diff_only": 0.08899998664855957,
        "tpp_threshold_50_unintended_diff_only": 0.005749985575675964,
        "tpp_threshold_100_total_metric": 0.3817500174045563,
        "tpp_threshold_100_intended_diff_only": 0.3920000195503235,
        "tpp_threshold_100_unintended_diff_only": 0.010250002145767212,
        "tpp_threshold_500_total_metric": 0.4742499887943268,
        "tpp_threshold_500_intended_diff_only": 0.4919999837875366,
        "tpp_threshold_500_unintended_diff_only": 0.01774999499320984
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.0004999637603759766,
        "tpp_threshold_2_intended_diff_only": 0.003999948501586914,
        "tpp_threshold_2_unintended_diff_only": 0.0034999847412109375,
        "tpp_threshold_5_total_metric": 0.011499971151351929,
        "tpp_threshold_5_intended_diff_only": 0.012999951839447021,
        "tpp_threshold_5_unintended_diff_only": 0.0014999806880950928,
        "tpp_threshold_10_total_metric": 0.03500001132488251,
        "tpp_threshold_10_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_10_unintended_diff_only": 0.006999984383583069,
        "tpp_threshold_20_total_metric": 0.09574995934963226,
        "tpp_threshold_20_intended_diff_only": 0.10099995136260986,
        "tpp_threshold_20_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_50_total_metric": 0.37550000846385956,
        "tpp_threshold_50_intended_diff_only": 0.3889999985694885,
        "tpp_threshold_50_unintended_diff_only": 0.013499990105628967,
        "tpp_threshold_100_total_metric": 0.453249990940094,
        "tpp_threshold_100_intended_diff_only": 0.4789999723434448,
        "tpp_threshold_100_unintended_diff_only": 0.02574998140335083,
        "tpp_threshold_500_total_metric": 0.4270000159740448,
        "tpp_threshold_500_intended_diff_only": 0.48000001907348633,
        "tpp_threshold_500_unintended_diff_only": 0.05300000309944153
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.0045000165700912476,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.009500011801719666,
        "tpp_threshold_5_total_metric": 0.0297500342130661,
        "tpp_threshold_5_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_5_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_10_total_metric": 0.05825001001358032,
        "tpp_threshold_10_intended_diff_only": 0.06300002336502075,
        "tpp_threshold_10_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_20_total_metric": 0.1849999874830246,
        "tpp_threshold_20_intended_diff_only": 0.19900000095367432,
        "tpp_threshold_20_unintended_diff_only": 0.01400001347064972,
        "tpp_threshold_50_total_metric": 0.2982500046491623,
        "tpp_threshold_50_intended_diff_only": 0.3140000104904175,
        "tpp_threshold_50_unintended_diff_only": 0.015750005841255188,
        "tpp_threshold_100_total_metric": 0.40175001323223114,
        "tpp_threshold_100_intended_diff_only": 0.42000001668930054,
        "tpp_threshold_100_unintended_diff_only": 0.018250003457069397,
        "tpp_threshold_500_total_metric": 0.38425005972385406,
        "tpp_threshold_500_intended_diff_only": 0.4440000653266907,
        "tpp_threshold_500_unintended_diff_only": 0.05975000560283661
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.013999998569488525,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": -0.0040000081062316895,
        "tpp_threshold_5_total_metric": 0.02575002610683441,
        "tpp_threshold_5_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_5_unintended_diff_only": 0.00925000011920929,
        "tpp_threshold_10_total_metric": 0.08500002324581146,
        "tpp_threshold_10_intended_diff_only": 0.0910000205039978,
        "tpp_threshold_10_unintended_diff_only": 0.00599999725818634,
        "tpp_threshold_20_total_metric": 0.12149998545646667,
        "tpp_threshold_20_intended_diff_only": 0.12999999523162842,
        "tpp_threshold_20_unintended_diff_only": 0.008500009775161743,
        "tpp_threshold_50_total_metric": 0.23500002920627594,
        "tpp_threshold_50_intended_diff_only": 0.25300002098083496,
        "tpp_threshold_50_unintended_diff_only": 0.01799999177455902,
        "tpp_threshold_100_total_metric": 0.3475000411272049,
        "tpp_threshold_100_intended_diff_only": 0.3670000433921814,
        "tpp_threshold_100_unintended_diff_only": 0.0195000022649765,
        "tpp_threshold_500_total_metric": 0.3762500435113907,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.0637500137090683
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.010749965906143188,
        "tpp_threshold_2_intended_diff_only": -0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_5_total_metric": -0.001749977469444275,
        "tpp_threshold_5_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": -0.00024999678134918213,
        "tpp_threshold_10_total_metric": 0.01600000262260437,
        "tpp_threshold_10_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_10_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_20_total_metric": 0.02925001084804535,
        "tpp_threshold_20_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_20_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_50_total_metric": 0.13825002312660217,
        "tpp_threshold_50_intended_diff_only": 0.1600000262260437,
        "tpp_threshold_50_unintended_diff_only": 0.02175000309944153,
        "tpp_threshold_100_total_metric": 0.283500000834465,
        "tpp_threshold_100_intended_diff_only": 0.3270000219345093,
        "tpp_threshold_100_unintended_diff_only": 0.04350002110004425,
        "tpp_threshold_500_total_metric": 0.3255000412464142,
        "tpp_threshold_500_intended_diff_only": 0.42200005054473877,
        "tpp_threshold_500_unintended_diff_only": 0.09650000929832458
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.016249999403953552,
        "tpp_threshold_2_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_2_unintended_diff_only": -0.0032499879598617554,
        "tpp_threshold_5_total_metric": 0.014749988913536072,
        "tpp_threshold_5_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_5_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_10_total_metric": 0.027749985456466675,
        "tpp_threshold_10_intended_diff_only": 0.02899998426437378,
        "tpp_threshold_10_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_20_total_metric": 0.10349999368190765,
        "tpp_threshold_20_intended_diff_only": 0.10699999332427979,
        "tpp_threshold_20_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_50_total_metric": 0.2120000123977661,
        "tpp_threshold_50_intended_diff_only": 0.22100001573562622,
        "tpp_threshold_50_unintended_diff_only": 0.009000003337860107,
        "tpp_threshold_100_total_metric": 0.3347499966621399,
        "tpp_threshold_100_intended_diff_only": 0.35199999809265137,
        "tpp_threshold_100_unintended_diff_only": 0.017250001430511475,
        "tpp_threshold_500_total_metric": 0.39625003933906555,
        "tpp_threshold_500_intended_diff_only": 0.4270000457763672,
        "tpp_threshold_500_unintended_diff_only": 0.030750006437301636
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.006750017404556274,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": 0.005250006914138794,
        "tpp_threshold_5_total_metric": 0.040750011801719666,
        "tpp_threshold_5_intended_diff_only": 0.04000002145767212,
        "tpp_threshold_5_unintended_diff_only": -0.0007499903440475464,
        "tpp_threshold_10_total_metric": 0.0689999908208847,
        "tpp_threshold_10_intended_diff_only": 0.07400000095367432,
        "tpp_threshold_10_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_20_total_metric": 0.12174999713897705,
        "tpp_threshold_20_intended_diff_only": 0.1290000081062317,
        "tpp_threshold_20_unintended_diff_only": 0.007250010967254639,
        "tpp_threshold_50_total_metric": 0.30675001442432404,
        "tpp_threshold_50_intended_diff_only": 0.3270000219345093,
        "tpp_threshold_50_unintended_diff_only": 0.02025000751018524,
        "tpp_threshold_100_total_metric": 0.3292500227689743,
        "tpp_threshold_100_intended_diff_only": 0.3630000352859497,
        "tpp_threshold_100_unintended_diff_only": 0.0337500125169754,
        "tpp_threshold_500_total_metric": 0.30500003695487976,
        "tpp_threshold_500_intended_diff_only": 0.3720000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.06700000166893005
      }
    }
  }
}