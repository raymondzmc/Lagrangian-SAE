{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "6a38b162-d79f-459c-99a6-f6c309cb68bb",
  "datetime_epoch_millis": 1769400917073,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0045500069856643675,
      "tpp_threshold_2_intended_diff_only": 0.006000000238418578,
      "tpp_threshold_2_unintended_diff_only": 0.0014499932527542113,
      "tpp_threshold_5_total_metric": 0.00927499830722809,
      "tpp_threshold_5_intended_diff_only": 0.0106999933719635,
      "tpp_threshold_5_unintended_diff_only": 0.0014249950647354124,
      "tpp_threshold_10_total_metric": 0.020374999940395357,
      "tpp_threshold_10_intended_diff_only": 0.02329999804496765,
      "tpp_threshold_10_unintended_diff_only": 0.002924998104572296,
      "tpp_threshold_20_total_metric": 0.0499500036239624,
      "tpp_threshold_20_intended_diff_only": 0.05879999995231629,
      "tpp_threshold_20_unintended_diff_only": 0.008849996328353881,
      "tpp_threshold_50_total_metric": 0.13302500545978546,
      "tpp_threshold_50_intended_diff_only": 0.16489999890327453,
      "tpp_threshold_50_unintended_diff_only": 0.031874993443489076,
      "tpp_threshold_100_total_metric": 0.21452501267194748,
      "tpp_threshold_100_intended_diff_only": 0.25170000791549685,
      "tpp_threshold_100_unintended_diff_only": 0.03717499524354935,
      "tpp_threshold_500_total_metric": 0.36610001921653745,
      "tpp_threshold_500_intended_diff_only": 0.4148000180721283,
      "tpp_threshold_500_unintended_diff_only": 0.04869999885559082
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.004250001907348633,
      "tpp_threshold_2_intended_diff_only": 0.005599987506866455,
      "tpp_threshold_2_unintended_diff_only": 0.0013499855995178223,
      "tpp_threshold_5_total_metric": 0.006949996948242188,
      "tpp_threshold_5_intended_diff_only": 0.007999980449676513,
      "tpp_threshold_5_unintended_diff_only": 0.0010499835014343261,
      "tpp_threshold_10_total_metric": 0.012049996852874756,
      "tpp_threshold_10_intended_diff_only": 0.014199984073638917,
      "tpp_threshold_10_unintended_diff_only": 0.0021499872207641603,
      "tpp_threshold_20_total_metric": 0.025900015234947206,
      "tpp_threshold_20_intended_diff_only": 0.028199994564056398,
      "tpp_threshold_20_unintended_diff_only": 0.002299979329109192,
      "tpp_threshold_50_total_metric": 0.10580000281333923,
      "tpp_threshold_50_intended_diff_only": 0.1425999879837036,
      "tpp_threshold_50_unintended_diff_only": 0.03679998517036438,
      "tpp_threshold_100_total_metric": 0.19070000648498536,
      "tpp_threshold_100_intended_diff_only": 0.23119999170303346,
      "tpp_threshold_100_unintended_diff_only": 0.040499985218048096,
      "tpp_threshold_500_total_metric": 0.3712000101804733,
      "tpp_threshold_500_intended_diff_only": 0.42139999866485595,
      "tpp_threshold_500_unintended_diff_only": 0.05019998848438263
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.004850012063980102,
      "tpp_threshold_2_intended_diff_only": 0.006400012969970703,
      "tpp_threshold_2_unintended_diff_only": 0.0015500009059906006,
      "tpp_threshold_5_total_metric": 0.01159999966621399,
      "tpp_threshold_5_intended_diff_only": 0.013400006294250488,
      "tpp_threshold_5_unintended_diff_only": 0.001800006628036499,
      "tpp_threshold_10_total_metric": 0.028700003027915956,
      "tpp_threshold_10_intended_diff_only": 0.03240001201629639,
      "tpp_threshold_10_unintended_diff_only": 0.003700008988380432,
      "tpp_threshold_20_total_metric": 0.0739999920129776,
      "tpp_threshold_20_intended_diff_only": 0.08940000534057617,
      "tpp_threshold_20_unintended_diff_only": 0.015400013327598572,
      "tpp_threshold_50_total_metric": 0.1602500081062317,
      "tpp_threshold_50_intended_diff_only": 0.18720000982284546,
      "tpp_threshold_50_unintended_diff_only": 0.02695000171661377,
      "tpp_threshold_100_total_metric": 0.2383500188589096,
      "tpp_threshold_100_intended_diff_only": 0.2722000241279602,
      "tpp_threshold_100_unintended_diff_only": 0.0338500052690506,
      "tpp_threshold_500_total_metric": 0.36100002825260163,
      "tpp_threshold_500_intended_diff_only": 0.40820003747940065,
      "tpp_threshold_500_unintended_diff_only": 0.04720000922679901
    }
  ],
  "sae_bench_commit_hash": "bcb8cfe0e327661851a33dcd1db5ff709206b410",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_lagrangian",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_lagrangian",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.007500007748603821,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": 0.002499982714653015,
        "tpp_threshold_5_total_metric": 0.01199999451637268,
        "tpp_threshold_5_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_5_unintended_diff_only": 0.003999978303909302,
        "tpp_threshold_10_total_metric": 0.01075001060962677,
        "tpp_threshold_10_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_10_unintended_diff_only": 0.004249975085258484,
        "tpp_threshold_20_total_metric": 0.025000005960464478,
        "tpp_threshold_20_intended_diff_only": 0.02899998426437378,
        "tpp_threshold_20_unintended_diff_only": 0.003999978303909302,
        "tpp_threshold_50_total_metric": 0.0767500102519989,
        "tpp_threshold_50_intended_diff_only": 0.08399999141693115,
        "tpp_threshold_50_unintended_diff_only": 0.007249981164932251,
        "tpp_threshold_100_total_metric": 0.14100000262260437,
        "tpp_threshold_100_intended_diff_only": 0.14899998903274536,
        "tpp_threshold_100_unintended_diff_only": 0.007999986410140991,
        "tpp_threshold_500_total_metric": 0.34050004184246063,
        "tpp_threshold_500_intended_diff_only": 0.36400002241134644,
        "tpp_threshold_500_unintended_diff_only": 0.023499980568885803
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.004500001668930054,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.0004999935626983643,
        "tpp_threshold_5_total_metric": 0.0034999847412109375,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": -0.000500023365020752,
        "tpp_threshold_10_total_metric": 0.011500000953674316,
        "tpp_threshold_10_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_10_unintended_diff_only": -0.000500023365020752,
        "tpp_threshold_20_total_metric": 0.02000001072883606,
        "tpp_threshold_20_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_20_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_50_total_metric": 0.051500022411346436,
        "tpp_threshold_50_intended_diff_only": 0.1290000081062317,
        "tpp_threshold_50_unintended_diff_only": 0.07749998569488525,
        "tpp_threshold_100_total_metric": 0.1682499796152115,
        "tpp_threshold_100_intended_diff_only": 0.25199997425079346,
        "tpp_threshold_100_unintended_diff_only": 0.08374999463558197,
        "tpp_threshold_500_total_metric": 0.3519999831914902,
        "tpp_threshold_500_intended_diff_only": 0.44599997997283936,
        "tpp_threshold_500_unintended_diff_only": 0.09399999678134918
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.002750024199485779,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.0012499839067459106,
        "tpp_threshold_5_total_metric": 0.009750038385391235,
        "tpp_threshold_5_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_5_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_10_total_metric": 0.024500012397766113,
        "tpp_threshold_10_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_10_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_20_total_metric": 0.045500025153160095,
        "tpp_threshold_20_intended_diff_only": 0.046000003814697266,
        "tpp_threshold_20_unintended_diff_only": 0.0004999786615371704,
        "tpp_threshold_50_total_metric": 0.20775003731250763,
        "tpp_threshold_50_intended_diff_only": 0.22100001573562622,
        "tpp_threshold_50_unintended_diff_only": 0.013249978423118591,
        "tpp_threshold_100_total_metric": 0.3017500340938568,
        "tpp_threshold_100_intended_diff_only": 0.31800001859664917,
        "tpp_threshold_100_unintended_diff_only": 0.01624998450279236,
        "tpp_threshold_500_total_metric": 0.4177500456571579,
        "tpp_threshold_500_intended_diff_only": 0.44200003147125244,
        "tpp_threshold_500_unintended_diff_only": 0.024249985814094543
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.004999995231628418,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_total_metric": 0.003000006079673767,
        "tpp_threshold_5_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": -0.0020000189542770386,
        "tpp_threshold_10_total_metric": 0.005000010132789612,
        "tpp_threshold_10_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_20_total_metric": 0.00625002384185791,
        "tpp_threshold_20_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_20_unintended_diff_only": -0.0012500286102294922,
        "tpp_threshold_50_total_metric": 0.04099997878074646,
        "tpp_threshold_50_intended_diff_only": 0.04399996995925903,
        "tpp_threshold_50_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_100_total_metric": 0.07350000739097595,
        "tpp_threshold_100_intended_diff_only": 0.07999998331069946,
        "tpp_threshold_100_unintended_diff_only": 0.006499975919723511,
        "tpp_threshold_500_total_metric": 0.3684999942779541,
        "tpp_threshold_500_intended_diff_only": 0.37599998712539673,
        "tpp_threshold_500_unintended_diff_only": 0.007499992847442627
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.0014999806880950928,
        "tpp_threshold_2_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_2_unintended_diff_only": 0.0014999806880950928,
        "tpp_threshold_5_total_metric": 0.006499961018562317,
        "tpp_threshold_5_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_5_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_10_total_metric": 0.008499950170516968,
        "tpp_threshold_10_intended_diff_only": 0.012999951839447021,
        "tpp_threshold_10_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_20_total_metric": 0.03275001049041748,
        "tpp_threshold_20_intended_diff_only": 0.03799998760223389,
        "tpp_threshold_20_unintended_diff_only": 0.005249977111816406,
        "tpp_threshold_50_total_metric": 0.15199996531009674,
        "tpp_threshold_50_intended_diff_only": 0.23499995470046997,
        "tpp_threshold_50_unintended_diff_only": 0.08299998939037323,
        "tpp_threshold_100_total_metric": 0.26900000870227814,
        "tpp_threshold_100_intended_diff_only": 0.3569999933242798,
        "tpp_threshold_100_unintended_diff_only": 0.08799998462200165,
        "tpp_threshold_500_total_metric": 0.37724998593330383,
        "tpp_threshold_500_intended_diff_only": 0.4789999723434448,
        "tpp_threshold_500_unintended_diff_only": 0.10174998641014099
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.003999963402748108,
        "tpp_threshold_2_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": 0.00599999725818634,
        "tpp_threshold_5_total_metric": -0.0004999935626983643,
        "tpp_threshold_5_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_10_total_metric": 0.008000016212463379,
        "tpp_threshold_10_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_10_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_total_metric": 0.011749997735023499,
        "tpp_threshold_20_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_20_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_50_total_metric": 0.1900000274181366,
        "tpp_threshold_50_intended_diff_only": 0.24700003862380981,
        "tpp_threshold_50_unintended_diff_only": 0.05700001120567322,
        "tpp_threshold_100_total_metric": 0.24000003933906555,
        "tpp_threshold_100_intended_diff_only": 0.3160000443458557,
        "tpp_threshold_100_unintended_diff_only": 0.07600000500679016,
        "tpp_threshold_500_total_metric": 0.3385000377893448,
        "tpp_threshold_500_intended_diff_only": 0.4320000410079956,
        "tpp_threshold_500_unintended_diff_only": 0.09350000321865082
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.014500036835670471,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": -0.002500012516975403,
        "tpp_threshold_5_total_metric": 0.009000018239021301,
        "tpp_threshold_5_intended_diff_only": 0.016000032424926758,
        "tpp_threshold_5_unintended_diff_only": 0.0070000141859054565,
        "tpp_threshold_10_total_metric": 0.03825002908706665,
        "tpp_threshold_10_intended_diff_only": 0.04400002956390381,
        "tpp_threshold_10_unintended_diff_only": 0.005750000476837158,
        "tpp_threshold_20_total_metric": 0.05124998092651367,
        "tpp_threshold_20_intended_diff_only": 0.0559999942779541,
        "tpp_threshold_20_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_50_total_metric": 0.10725001990795135,
        "tpp_threshold_50_intended_diff_only": 0.11500000953674316,
        "tpp_threshold_50_unintended_diff_only": 0.007749989628791809,
        "tpp_threshold_100_total_metric": 0.15025001764297485,
        "tpp_threshold_100_intended_diff_only": 0.1600000262260437,
        "tpp_threshold_100_unintended_diff_only": 0.009750008583068848,
        "tpp_threshold_500_total_metric": 0.38200004398822784,
        "tpp_threshold_500_intended_diff_only": 0.42200005054473877,
        "tpp_threshold_500_unintended_diff_only": 0.040000006556510925
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.0070000141859054565,
        "tpp_threshold_2_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_5_total_metric": -0.0040000081062316895,
        "tpp_threshold_5_intended_diff_only": -0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": -0.0009999871253967285,
        "tpp_threshold_10_total_metric": 0.016500011086463928,
        "tpp_threshold_10_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_10_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_20_total_metric": 0.0897500216960907,
        "tpp_threshold_20_intended_diff_only": 0.11400002241134644,
        "tpp_threshold_20_unintended_diff_only": 0.024250000715255737,
        "tpp_threshold_50_total_metric": 0.1457500010728836,
        "tpp_threshold_50_intended_diff_only": 0.17100000381469727,
        "tpp_threshold_50_unintended_diff_only": 0.02525000274181366,
        "tpp_threshold_100_total_metric": 0.24900001287460327,
        "tpp_threshold_100_intended_diff_only": 0.2710000276565552,
        "tpp_threshold_100_unintended_diff_only": 0.022000014781951904,
        "tpp_threshold_500_total_metric": 0.3682500272989273,
        "tpp_threshold_500_intended_diff_only": 0.4010000228881836,
        "tpp_threshold_500_unintended_diff_only": 0.03274999558925629
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.014500021934509277,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": -0.002499997615814209,
        "tpp_threshold_5_total_metric": 0.025000005960464478,
        "tpp_threshold_5_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_5_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_10_total_metric": 0.028499960899353027,
        "tpp_threshold_10_intended_diff_only": 0.0339999794960022,
        "tpp_threshold_10_unintended_diff_only": 0.00550001859664917,
        "tpp_threshold_20_total_metric": 0.03924998641014099,
        "tpp_threshold_20_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_20_unintended_diff_only": 0.002750009298324585,
        "tpp_threshold_50_total_metric": 0.07924997806549072,
        "tpp_threshold_50_intended_diff_only": 0.07999998331069946,
        "tpp_threshold_50_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_100_total_metric": 0.24175001680850983,
        "tpp_threshold_100_intended_diff_only": 0.2580000162124634,
        "tpp_threshold_100_unintended_diff_only": 0.016249999403953552,
        "tpp_threshold_500_total_metric": 0.39750000834465027,
        "tpp_threshold_500_intended_diff_only": 0.4140000343322754,
        "tpp_threshold_500_unintended_diff_only": 0.016500025987625122
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.006249979138374329,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_5_total_metric": 0.02849997580051422,
        "tpp_threshold_5_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_5_unintended_diff_only": -0.0034999996423721313,
        "tpp_threshold_10_total_metric": 0.05224999785423279,
        "tpp_threshold_10_intended_diff_only": 0.05500000715255737,
        "tpp_threshold_10_unintended_diff_only": 0.002750009298324585,
        "tpp_threshold_20_total_metric": 0.17799997329711914,
        "tpp_threshold_20_intended_diff_only": 0.21700000762939453,
        "tpp_threshold_20_unintended_diff_only": 0.03900003433227539,
        "tpp_threshold_50_total_metric": 0.27900001406669617,
        "tpp_threshold_50_intended_diff_only": 0.3230000138282776,
        "tpp_threshold_50_unintended_diff_only": 0.04399999976158142,
        "tpp_threshold_100_total_metric": 0.31075000762939453,
        "tpp_threshold_100_intended_diff_only": 0.35600000619888306,
        "tpp_threshold_100_unintended_diff_only": 0.045249998569488525,
        "tpp_threshold_500_total_metric": 0.3187500238418579,
        "tpp_threshold_500_intended_diff_only": 0.3720000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.053250014781951904
      }
    }
  }
}