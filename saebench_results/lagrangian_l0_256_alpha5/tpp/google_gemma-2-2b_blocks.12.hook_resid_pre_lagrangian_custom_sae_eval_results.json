{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "b92f5bae-044e-418e-9527-5ed8923c7be4",
  "datetime_epoch_millis": 1769400937812,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0028000056743621824,
      "tpp_threshold_2_intended_diff_only": 0.0034000039100646976,
      "tpp_threshold_2_unintended_diff_only": 0.0005999982357025146,
      "tpp_threshold_5_total_metric": 0.006174997985363006,
      "tpp_threshold_5_intended_diff_only": 0.007199996709823608,
      "tpp_threshold_5_unintended_diff_only": 0.0010249987244606018,
      "tpp_threshold_10_total_metric": 0.022225001454353334,
      "tpp_threshold_10_intended_diff_only": 0.025599998235702512,
      "tpp_threshold_10_unintended_diff_only": 0.0033749967813491823,
      "tpp_threshold_20_total_metric": 0.09290000796318054,
      "tpp_threshold_20_intended_diff_only": 0.1003000020980835,
      "tpp_threshold_20_unintended_diff_only": 0.007399994134902953,
      "tpp_threshold_50_total_metric": 0.2765250146389008,
      "tpp_threshold_50_intended_diff_only": 0.303600013256073,
      "tpp_threshold_50_unintended_diff_only": 0.02707499861717224,
      "tpp_threshold_100_total_metric": 0.38232501447200773,
      "tpp_threshold_100_intended_diff_only": 0.4307000160217285,
      "tpp_threshold_100_unintended_diff_only": 0.04837500154972076,
      "tpp_threshold_500_total_metric": 0.34485004246234896,
      "tpp_threshold_500_intended_diff_only": 0.44450004100799556,
      "tpp_threshold_500_unintended_diff_only": 0.09964999854564666
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.004000002145767212,
      "tpp_threshold_2_intended_diff_only": 0.004399991035461426,
      "tpp_threshold_2_unintended_diff_only": 0.00039998888969421386,
      "tpp_threshold_5_total_metric": 0.005050012469291687,
      "tpp_threshold_5_intended_diff_only": 0.005799996852874756,
      "tpp_threshold_5_unintended_diff_only": 0.0007499843835830688,
      "tpp_threshold_10_total_metric": 0.01969999372959137,
      "tpp_threshold_10_intended_diff_only": 0.024399983882904052,
      "tpp_threshold_10_unintended_diff_only": 0.004699990153312683,
      "tpp_threshold_20_total_metric": 0.11435000896453858,
      "tpp_threshold_20_intended_diff_only": 0.12259999513626099,
      "tpp_threshold_20_unintended_diff_only": 0.008249986171722411,
      "tpp_threshold_50_total_metric": 0.30660001933574677,
      "tpp_threshold_50_intended_diff_only": 0.3343999981880188,
      "tpp_threshold_50_unintended_diff_only": 0.027799978852272034,
      "tpp_threshold_100_total_metric": 0.40340001583099366,
      "tpp_threshold_100_intended_diff_only": 0.45140000581741335,
      "tpp_threshold_100_unintended_diff_only": 0.047999989986419675,
      "tpp_threshold_500_total_metric": 0.3674000442028046,
      "tpp_threshold_500_intended_diff_only": 0.4680000305175781,
      "tpp_threshold_500_unintended_diff_only": 0.10059998631477356
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0016000092029571534,
      "tpp_threshold_2_intended_diff_only": 0.0024000167846679687,
      "tpp_threshold_2_unintended_diff_only": 0.0008000075817108154,
      "tpp_threshold_5_total_metric": 0.007299983501434326,
      "tpp_threshold_5_intended_diff_only": 0.008599996566772461,
      "tpp_threshold_5_unintended_diff_only": 0.0013000130653381347,
      "tpp_threshold_10_total_metric": 0.024750009179115295,
      "tpp_threshold_10_intended_diff_only": 0.026800012588500975,
      "tpp_threshold_10_unintended_diff_only": 0.002050003409385681,
      "tpp_threshold_20_total_metric": 0.07145000696182251,
      "tpp_threshold_20_intended_diff_only": 0.078000009059906,
      "tpp_threshold_20_unintended_diff_only": 0.006550002098083496,
      "tpp_threshold_50_total_metric": 0.24645000994205474,
      "tpp_threshold_50_intended_diff_only": 0.2728000283241272,
      "tpp_threshold_50_unintended_diff_only": 0.02635001838207245,
      "tpp_threshold_100_total_metric": 0.36125001311302185,
      "tpp_threshold_100_intended_diff_only": 0.4100000262260437,
      "tpp_threshold_100_unintended_diff_only": 0.04875001311302185,
      "tpp_threshold_500_total_metric": 0.32230004072189333,
      "tpp_threshold_500_intended_diff_only": 0.4210000514984131,
      "tpp_threshold_500_unintended_diff_only": 0.09870001077651977
    }
  ],
  "sae_bench_commit_hash": "bcb8cfe0e327661851a33dcd1db5ff709206b410",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_lagrangian",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_lagrangian",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": -0.0002499818801879883,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0002499818801879883,
        "tpp_threshold_5_total_metric": 0.0017500221729278564,
        "tpp_threshold_5_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_10_total_metric": 0.007249981164932251,
        "tpp_threshold_10_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_10_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_20_total_metric": 0.04924999177455902,
        "tpp_threshold_20_intended_diff_only": 0.05699998140335083,
        "tpp_threshold_20_unintended_diff_only": 0.007749989628791809,
        "tpp_threshold_50_total_metric": 0.2222500443458557,
        "tpp_threshold_50_intended_diff_only": 0.23900002241134644,
        "tpp_threshold_50_unintended_diff_only": 0.016749978065490723,
        "tpp_threshold_100_total_metric": 0.3890000134706497,
        "tpp_threshold_100_intended_diff_only": 0.43400001525878906,
        "tpp_threshold_100_unintended_diff_only": 0.04500000178813934,
        "tpp_threshold_500_total_metric": 0.3602500259876251,
        "tpp_threshold_500_intended_diff_only": 0.44700002670288086,
        "tpp_threshold_500_unintended_diff_only": 0.08675000071525574
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.006749987602233887,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": -0.0007500052452087402,
        "tpp_threshold_5_total_metric": 0.008000016212463379,
        "tpp_threshold_5_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_5_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_10_total_metric": 0.03874997794628143,
        "tpp_threshold_10_intended_diff_only": 0.04899996519088745,
        "tpp_threshold_10_unintended_diff_only": 0.010249987244606018,
        "tpp_threshold_20_total_metric": 0.11925001442432404,
        "tpp_threshold_20_intended_diff_only": 0.13499999046325684,
        "tpp_threshold_20_unintended_diff_only": 0.0157499760389328,
        "tpp_threshold_50_total_metric": 0.3985000103712082,
        "tpp_threshold_50_intended_diff_only": 0.45499998331069946,
        "tpp_threshold_50_unintended_diff_only": 0.05649997293949127,
        "tpp_threshold_100_total_metric": 0.36100004613399506,
        "tpp_threshold_100_intended_diff_only": 0.4650000333786011,
        "tpp_threshold_100_unintended_diff_only": 0.10399998724460602,
        "tpp_threshold_500_total_metric": 0.28025004267692566,
        "tpp_threshold_500_intended_diff_only": 0.4650000333786011,
        "tpp_threshold_500_unintended_diff_only": 0.18474999070167542
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.0040000081062316895,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_total_metric": 0.006000041961669922,
        "tpp_threshold_5_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_5_unintended_diff_only": 0.001999974250793457,
        "tpp_threshold_10_total_metric": 0.020500019192695618,
        "tpp_threshold_10_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_10_unintended_diff_only": 0.002499982714653015,
        "tpp_threshold_20_total_metric": 0.2057500183582306,
        "tpp_threshold_20_intended_diff_only": 0.21299999952316284,
        "tpp_threshold_20_unintended_diff_only": 0.007249981164932251,
        "tpp_threshold_50_total_metric": 0.39875006675720215,
        "tpp_threshold_50_intended_diff_only": 0.437000036239624,
        "tpp_threshold_50_unintended_diff_only": 0.038249969482421875,
        "tpp_threshold_100_total_metric": 0.4072500169277191,
        "tpp_threshold_100_intended_diff_only": 0.45399999618530273,
        "tpp_threshold_100_unintended_diff_only": 0.04674997925758362,
        "tpp_threshold_500_total_metric": 0.3705000728368759,
        "tpp_threshold_500_intended_diff_only": 0.45500004291534424,
        "tpp_threshold_500_unintended_diff_only": 0.08449997007846832
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.009000018239021301,
        "tpp_threshold_2_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_5_total_metric": 0.00449998676776886,
        "tpp_threshold_5_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": -0.002500012516975403,
        "tpp_threshold_10_total_metric": 0.00950002670288086,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": -0.000500023365020752,
        "tpp_threshold_20_total_metric": 0.015750005841255188,
        "tpp_threshold_20_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_20_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_50_total_metric": 0.09749998152256012,
        "tpp_threshold_50_intended_diff_only": 0.10499995946884155,
        "tpp_threshold_50_unintended_diff_only": 0.007499977946281433,
        "tpp_threshold_100_total_metric": 0.4125000089406967,
        "tpp_threshold_100_intended_diff_only": 0.4259999990463257,
        "tpp_threshold_100_unintended_diff_only": 0.013499990105628967,
        "tpp_threshold_500_total_metric": 0.43650004267692566,
        "tpp_threshold_500_intended_diff_only": 0.4930000305175781,
        "tpp_threshold_500_unintended_diff_only": 0.056499987840652466
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.0004999786615371704,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_5_total_metric": 0.004999995231628418,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_10_total_metric": 0.022499963641166687,
        "tpp_threshold_10_intended_diff_only": 0.029999971389770508,
        "tpp_threshold_10_unintended_diff_only": 0.007500007748603821,
        "tpp_threshold_20_total_metric": 0.18175001442432404,
        "tpp_threshold_20_intended_diff_only": 0.1899999976158142,
        "tpp_threshold_20_unintended_diff_only": 0.008249983191490173,
        "tpp_threshold_50_total_metric": 0.41599999368190765,
        "tpp_threshold_50_intended_diff_only": 0.4359999895095825,
        "tpp_threshold_50_unintended_diff_only": 0.019999995827674866,
        "tpp_threshold_100_total_metric": 0.44724999368190765,
        "tpp_threshold_100_intended_diff_only": 0.4779999852180481,
        "tpp_threshold_100_unintended_diff_only": 0.030749991536140442,
        "tpp_threshold_500_total_metric": 0.38950003683567047,
        "tpp_threshold_500_intended_diff_only": 0.48000001907348633,
        "tpp_threshold_500_unintended_diff_only": 0.09049998223781586
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.006499975919723511,
        "tpp_threshold_2_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_5_total_metric": -0.0052499920129776,
        "tpp_threshold_5_intended_diff_only": -0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": 0.0022500306367874146,
        "tpp_threshold_10_total_metric": -0.0002499818801879883,
        "tpp_threshold_10_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_10_unintended_diff_only": 0.0032500028610229492,
        "tpp_threshold_20_total_metric": -0.0012499988079071045,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": 0.005250006914138794,
        "tpp_threshold_50_total_metric": 0.17325003445148468,
        "tpp_threshold_50_intended_diff_only": 0.1950000524520874,
        "tpp_threshold_50_unintended_diff_only": 0.021750018000602722,
        "tpp_threshold_100_total_metric": 0.364250048995018,
        "tpp_threshold_100_intended_diff_only": 0.41700005531311035,
        "tpp_threshold_100_unintended_diff_only": 0.052750006318092346,
        "tpp_threshold_500_total_metric": 0.33250005543231964,
        "tpp_threshold_500_intended_diff_only": 0.4440000653266907,
        "tpp_threshold_500_unintended_diff_only": 0.11150000989437103
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.014749988913536072,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": -0.004749998450279236,
        "tpp_threshold_5_total_metric": 0.008749976754188538,
        "tpp_threshold_5_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_5_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_10_total_metric": 0.03025004267692566,
        "tpp_threshold_10_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_10_unintended_diff_only": 0.004749983549118042,
        "tpp_threshold_20_total_metric": 0.10425004363059998,
        "tpp_threshold_20_intended_diff_only": 0.10900002717971802,
        "tpp_threshold_20_unintended_diff_only": 0.004749983549118042,
        "tpp_threshold_50_total_metric": 0.268249973654747,
        "tpp_threshold_50_intended_diff_only": 0.29600000381469727,
        "tpp_threshold_50_unintended_diff_only": 0.027750030159950256,
        "tpp_threshold_100_total_metric": 0.3659999817609787,
        "tpp_threshold_100_intended_diff_only": 0.4390000104904175,
        "tpp_threshold_100_unintended_diff_only": 0.07300002872943878,
        "tpp_threshold_500_total_metric": 0.32050004601478577,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.11950001120567322
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.00849999487400055,
        "tpp_threshold_2_intended_diff_only": -0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_5_total_metric": -0.003500029444694519,
        "tpp_threshold_5_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": -0.0004999786615371704,
        "tpp_threshold_10_total_metric": 0.011750012636184692,
        "tpp_threshold_10_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_10_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_20_total_metric": 0.05425001680850983,
        "tpp_threshold_20_intended_diff_only": 0.06300002336502075,
        "tpp_threshold_20_unintended_diff_only": 0.008750006556510925,
        "tpp_threshold_50_total_metric": 0.22800001502037048,
        "tpp_threshold_50_intended_diff_only": 0.25700002908706665,
        "tpp_threshold_50_unintended_diff_only": 0.029000014066696167,
        "tpp_threshold_100_total_metric": 0.3530000001192093,
        "tpp_threshold_100_intended_diff_only": 0.41100001335144043,
        "tpp_threshold_100_unintended_diff_only": 0.05800001323223114,
        "tpp_threshold_500_total_metric": 0.3175000548362732,
        "tpp_threshold_500_intended_diff_only": 0.42200005054473877,
        "tpp_threshold_500_unintended_diff_only": 0.10449999570846558
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.015250012278556824,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": -0.0032499879598617554,
        "tpp_threshold_5_total_metric": 0.02324998378753662,
        "tpp_threshold_5_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_5_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_10_total_metric": 0.03999999165534973,
        "tpp_threshold_10_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_10_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_20_total_metric": 0.08150000870227814,
        "tpp_threshold_20_intended_diff_only": 0.09200000762939453,
        "tpp_threshold_20_unintended_diff_only": 0.010499998927116394,
        "tpp_threshold_50_total_metric": 0.31150002777576447,
        "tpp_threshold_50_intended_diff_only": 0.3580000400543213,
        "tpp_threshold_50_unintended_diff_only": 0.046500012278556824,
        "tpp_threshold_100_total_metric": 0.37800000607967377,
        "tpp_threshold_100_intended_diff_only": 0.42500001192092896,
        "tpp_threshold_100_unintended_diff_only": 0.04700000584125519,
        "tpp_threshold_500_total_metric": 0.3382500261068344,
        "tpp_threshold_500_intended_diff_only": 0.4270000457763672,
        "tpp_threshold_500_unintended_diff_only": 0.08875001966953278
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.006999984383583069,
        "tpp_threshold_2_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_5_total_metric": 0.013249978423118591,
        "tpp_threshold_5_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_5_unintended_diff_only": -0.0032499879598617554,
        "tpp_threshold_10_total_metric": 0.04199998080730438,
        "tpp_threshold_10_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_10_unintended_diff_only": 1.4901161193847656e-08,
        "tpp_threshold_20_total_metric": 0.11849996447563171,
        "tpp_threshold_20_intended_diff_only": 0.12199997901916504,
        "tpp_threshold_20_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_50_total_metric": 0.2512499988079071,
        "tpp_threshold_50_intended_diff_only": 0.2580000162124634,
        "tpp_threshold_50_unintended_diff_only": 0.006750017404556274,
        "tpp_threshold_100_total_metric": 0.3450000286102295,
        "tpp_threshold_100_intended_diff_only": 0.3580000400543213,
        "tpp_threshold_100_unintended_diff_only": 0.013000011444091797,
        "tpp_threshold_500_total_metric": 0.30275002121925354,
        "tpp_threshold_500_intended_diff_only": 0.3720000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.06925001740455627
      }
    }
  }
}