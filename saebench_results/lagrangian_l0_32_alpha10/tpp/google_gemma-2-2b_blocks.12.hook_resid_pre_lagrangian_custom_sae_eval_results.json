{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "5ae5ea80-f0e5-44ca-8b6d-b5ed96c12933",
  "datetime_epoch_millis": 1769400941941,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.005424997210502625,
      "tpp_threshold_2_intended_diff_only": 0.0064999938011169435,
      "tpp_threshold_2_unintended_diff_only": 0.0010749965906143189,
      "tpp_threshold_5_total_metric": 0.00807499885559082,
      "tpp_threshold_5_intended_diff_only": 0.00899999737739563,
      "tpp_threshold_5_unintended_diff_only": 0.0009249985218048097,
      "tpp_threshold_10_total_metric": 0.020000001788139342,
      "tpp_threshold_10_intended_diff_only": 0.02409999370574951,
      "tpp_threshold_10_unintended_diff_only": 0.004099991917610168,
      "tpp_threshold_20_total_metric": 0.03362499922513962,
      "tpp_threshold_20_intended_diff_only": 0.03899999856948852,
      "tpp_threshold_20_unintended_diff_only": 0.005374999344348907,
      "tpp_threshold_50_total_metric": 0.07282501310110093,
      "tpp_threshold_50_intended_diff_only": 0.08590000867843628,
      "tpp_threshold_50_unintended_diff_only": 0.013074995577335357,
      "tpp_threshold_100_total_metric": 0.11342501640319824,
      "tpp_threshold_100_intended_diff_only": 0.1349000096321106,
      "tpp_threshold_100_unintended_diff_only": 0.021474993228912352,
      "tpp_threshold_500_total_metric": 0.23400002121925353,
      "tpp_threshold_500_intended_diff_only": 0.2613000154495239,
      "tpp_threshold_500_unintended_diff_only": 0.027299994230270387
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.005799990892410278,
      "tpp_threshold_2_intended_diff_only": 0.007199978828430176,
      "tpp_threshold_2_unintended_diff_only": 0.0013999879360198975,
      "tpp_threshold_5_total_metric": 0.007350006699562072,
      "tpp_threshold_5_intended_diff_only": 0.008199989795684814,
      "tpp_threshold_5_unintended_diff_only": 0.0008499830961227417,
      "tpp_threshold_10_total_metric": 0.01744999587535858,
      "tpp_threshold_10_intended_diff_only": 0.023999977111816406,
      "tpp_threshold_10_unintended_diff_only": 0.0065499812364578245,
      "tpp_threshold_20_total_metric": 0.029549992084503172,
      "tpp_threshold_20_intended_diff_only": 0.03559998273849487,
      "tpp_threshold_20_unintended_diff_only": 0.006049990653991699,
      "tpp_threshold_50_total_metric": 0.0727000206708908,
      "tpp_threshold_50_intended_diff_only": 0.09420000314712525,
      "tpp_threshold_50_unintended_diff_only": 0.021499982476234435,
      "tpp_threshold_100_total_metric": 0.11830001473426818,
      "tpp_threshold_100_intended_diff_only": 0.15299999713897705,
      "tpp_threshold_100_unintended_diff_only": 0.03469998240470886,
      "tpp_threshold_500_total_metric": 0.258950012922287,
      "tpp_threshold_500_intended_diff_only": 0.2990000009536743,
      "tpp_threshold_500_unintended_diff_only": 0.04004998803138733
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.005050003528594971,
      "tpp_threshold_2_intended_diff_only": 0.005800008773803711,
      "tpp_threshold_2_unintended_diff_only": 0.0007500052452087402,
      "tpp_threshold_5_total_metric": 0.008799991011619568,
      "tpp_threshold_5_intended_diff_only": 0.009800004959106445,
      "tpp_threshold_5_unintended_diff_only": 0.0010000139474868775,
      "tpp_threshold_10_total_metric": 0.022550007700920104,
      "tpp_threshold_10_intended_diff_only": 0.024200010299682616,
      "tpp_threshold_10_unintended_diff_only": 0.0016500025987625123,
      "tpp_threshold_20_total_metric": 0.03770000636577606,
      "tpp_threshold_20_intended_diff_only": 0.042400014400482175,
      "tpp_threshold_20_unintended_diff_only": 0.004700008034706116,
      "tpp_threshold_50_total_metric": 0.07295000553131104,
      "tpp_threshold_50_intended_diff_only": 0.07760001420974731,
      "tpp_threshold_50_unintended_diff_only": 0.004650008678436279,
      "tpp_threshold_100_total_metric": 0.1085500180721283,
      "tpp_threshold_100_intended_diff_only": 0.11680002212524414,
      "tpp_threshold_100_unintended_diff_only": 0.008250004053115845,
      "tpp_threshold_500_total_metric": 0.2090500295162201,
      "tpp_threshold_500_intended_diff_only": 0.22360002994537354,
      "tpp_threshold_500_unintended_diff_only": 0.014550000429153442
    }
  ],
  "sae_bench_commit_hash": "bcb8cfe0e327661851a33dcd1db5ff709206b410",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_lagrangian",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_lagrangian",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0012499988079071045,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.0007499754428863525,
        "tpp_threshold_5_total_metric": -0.0007500201463699341,
        "tpp_threshold_5_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_10_total_metric": -0.004500001668930054,
        "tpp_threshold_10_intended_diff_only": -0.0020000338554382324,
        "tpp_threshold_10_unintended_diff_only": 0.0024999678134918213,
        "tpp_threshold_20_total_metric": 1.4901161193847656e-08,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": 0.003999993205070496,
        "tpp_threshold_50_total_metric": 0.11550001800060272,
        "tpp_threshold_50_intended_diff_only": 0.18400001525878906,
        "tpp_threshold_50_unintended_diff_only": 0.06849999725818634,
        "tpp_threshold_100_total_metric": 0.16949999332427979,
        "tpp_threshold_100_intended_diff_only": 0.2369999885559082,
        "tpp_threshold_100_unintended_diff_only": 0.06749999523162842,
        "tpp_threshold_500_total_metric": 0.278750017285347,
        "tpp_threshold_500_intended_diff_only": 0.35600000619888306,
        "tpp_threshold_500_unintended_diff_only": 0.07724998891353607
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.005749985575675964,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_5_total_metric": 0.009250015020370483,
        "tpp_threshold_5_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_5_unintended_diff_only": 0.0007499754428863525,
        "tpp_threshold_10_total_metric": 0.052249982953071594,
        "tpp_threshold_10_intended_diff_only": 0.0769999623298645,
        "tpp_threshold_10_unintended_diff_only": 0.024749979376792908,
        "tpp_threshold_20_total_metric": 0.06899997591972351,
        "tpp_threshold_20_intended_diff_only": 0.09499996900558472,
        "tpp_threshold_20_unintended_diff_only": 0.025999993085861206,
        "tpp_threshold_50_total_metric": 0.09975001215934753,
        "tpp_threshold_50_intended_diff_only": 0.12999999523162842,
        "tpp_threshold_50_unintended_diff_only": 0.030249983072280884,
        "tpp_threshold_100_total_metric": 0.18574999272823334,
        "tpp_threshold_100_intended_diff_only": 0.2149999737739563,
        "tpp_threshold_100_unintended_diff_only": 0.02924998104572296,
        "tpp_threshold_500_total_metric": 0.3437499850988388,
        "tpp_threshold_500_intended_diff_only": 0.37599998712539673,
        "tpp_threshold_500_unintended_diff_only": 0.03225000202655792
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.01199999451637268,
        "tpp_threshold_2_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_2_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_5_total_metric": 0.014000028371810913,
        "tpp_threshold_5_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_5_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_10_total_metric": 0.025000035762786865,
        "tpp_threshold_10_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_10_unintended_diff_only": 0.001999974250793457,
        "tpp_threshold_20_total_metric": 0.04175002872943878,
        "tpp_threshold_20_intended_diff_only": 0.04100000858306885,
        "tpp_threshold_20_unintended_diff_only": -0.0007500201463699341,
        "tpp_threshold_50_total_metric": 0.05675005912780762,
        "tpp_threshold_50_intended_diff_only": 0.058000028133392334,
        "tpp_threshold_50_unintended_diff_only": 0.0012499690055847168,
        "tpp_threshold_100_total_metric": 0.07425004243850708,
        "tpp_threshold_100_intended_diff_only": 0.1420000195503235,
        "tpp_threshold_100_unintended_diff_only": 0.0677499771118164,
        "tpp_threshold_500_total_metric": 0.23075003921985626,
        "tpp_threshold_500_intended_diff_only": 0.30400002002716064,
        "tpp_threshold_500_unintended_diff_only": 0.07324998080730438
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.010250002145767212,
        "tpp_threshold_2_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_2_unintended_diff_only": 0.0007499754428863525,
        "tpp_threshold_5_total_metric": 0.008500009775161743,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": -0.0025000274181365967,
        "tpp_threshold_10_total_metric": 0.007749989628791809,
        "tpp_threshold_10_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_10_unintended_diff_only": -0.0007500201463699341,
        "tpp_threshold_20_total_metric": 0.012999996542930603,
        "tpp_threshold_20_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_20_unintended_diff_only": -0.0020000189542770386,
        "tpp_threshold_50_total_metric": 0.013500019907951355,
        "tpp_threshold_50_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_50_unintended_diff_only": 0.0004999786615371704,
        "tpp_threshold_100_total_metric": 0.021500036120414734,
        "tpp_threshold_100_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_100_unintended_diff_only": 0.001499965786933899,
        "tpp_threshold_500_total_metric": 0.06125001609325409,
        "tpp_threshold_500_intended_diff_only": 0.06499999761581421,
        "tpp_threshold_500_unintended_diff_only": 0.0037499815225601196
      },
      "9": {
        "tpp_threshold_2_total_metric": -0.0002500265836715698,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_5_total_metric": 0.005750000476837158,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.0002499818801879883,
        "tpp_threshold_10_total_metric": 0.006749972701072693,
        "tpp_threshold_10_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_10_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_20_total_metric": 0.02399994432926178,
        "tpp_threshold_20_intended_diff_only": 0.026999950408935547,
        "tpp_threshold_20_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_50_total_metric": 0.07799999415874481,
        "tpp_threshold_50_intended_diff_only": 0.08499997854232788,
        "tpp_threshold_50_unintended_diff_only": 0.006999984383583069,
        "tpp_threshold_100_total_metric": 0.140500009059906,
        "tpp_threshold_100_intended_diff_only": 0.14800000190734863,
        "tpp_threshold_100_unintended_diff_only": 0.007499992847442627,
        "tpp_threshold_500_total_metric": 0.3802500069141388,
        "tpp_threshold_500_intended_diff_only": 0.39399999380111694,
        "tpp_threshold_500_unintended_diff_only": 0.01374998688697815
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.004749998450279236,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_5_total_metric": -0.00449998676776886,
        "tpp_threshold_5_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_10_total_metric": 0.0020000040531158447,
        "tpp_threshold_10_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_10_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_20_total_metric": -1.4901161193847656e-08,
        "tpp_threshold_20_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_20_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_50_total_metric": 0.022250041365623474,
        "tpp_threshold_50_intended_diff_only": 0.024000048637390137,
        "tpp_threshold_50_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_100_total_metric": 0.03275005519390106,
        "tpp_threshold_100_intended_diff_only": 0.03800004720687866,
        "tpp_threshold_100_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_500_total_metric": 0.13275004923343658,
        "tpp_threshold_500_intended_diff_only": 0.16700005531311035,
        "tpp_threshold_500_unintended_diff_only": 0.03425000607967377
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.01874999701976776,
        "tpp_threshold_2_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_2_unintended_diff_only": -0.004749998450279236,
        "tpp_threshold_5_total_metric": 0.015500009059906006,
        "tpp_threshold_5_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_5_unintended_diff_only": 0.00550001859664917,
        "tpp_threshold_10_total_metric": 0.0339999794960022,
        "tpp_threshold_10_intended_diff_only": 0.03799998760223389,
        "tpp_threshold_10_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_total_metric": 0.032750025391578674,
        "tpp_threshold_20_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_20_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_50_total_metric": 0.055250003933906555,
        "tpp_threshold_50_intended_diff_only": 0.06400001049041748,
        "tpp_threshold_50_unintended_diff_only": 0.008750006556510925,
        "tpp_threshold_100_total_metric": 0.13075001537799835,
        "tpp_threshold_100_intended_diff_only": 0.13700002431869507,
        "tpp_threshold_100_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_500_total_metric": 0.25550004839897156,
        "tpp_threshold_500_intended_diff_only": 0.26100003719329834,
        "tpp_threshold_500_unintended_diff_only": 0.005499988794326782
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.009249985218048096,
        "tpp_threshold_2_intended_diff_only": -0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_5_total_metric": -0.0022500306367874146,
        "tpp_threshold_5_intended_diff_only": -0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": -0.0007499903440475464,
        "tpp_threshold_10_total_metric": 0.00700002908706665,
        "tpp_threshold_10_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_10_unintended_diff_only": 0.0,
        "tpp_threshold_20_total_metric": -0.0034999698400497437,
        "tpp_threshold_20_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_20_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_50_total_metric": 0.019749969244003296,
        "tpp_threshold_50_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_50_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_100_total_metric": 0.05825001001358032,
        "tpp_threshold_100_intended_diff_only": 0.06300002336502075,
        "tpp_threshold_100_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_500_total_metric": 0.13575001060962677,
        "tpp_threshold_500_intended_diff_only": 0.1420000195503235,
        "tpp_threshold_500_unintended_diff_only": 0.006250008940696716
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.014500021934509277,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": -0.002499997615814209,
        "tpp_threshold_5_total_metric": 0.013499990105628967,
        "tpp_threshold_5_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_5_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_10_total_metric": 0.01675000786781311,
        "tpp_threshold_10_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_10_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_20_total_metric": 0.018000006675720215,
        "tpp_threshold_20_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_20_unintended_diff_only": -0.0009999871253967285,
        "tpp_threshold_50_total_metric": 0.043000027537345886,
        "tpp_threshold_50_intended_diff_only": 0.04400002956390381,
        "tpp_threshold_50_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_100_total_metric": 0.058000028133392334,
        "tpp_threshold_100_intended_diff_only": 0.06300002336502075,
        "tpp_threshold_100_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_500_total_metric": 0.18525002896785736,
        "tpp_threshold_500_intended_diff_only": 0.18800002336502075,
        "tpp_threshold_500_unintended_diff_only": 0.002749994397163391
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0059999823570251465,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_total_metric": 0.02174997329711914,
        "tpp_threshold_5_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_5_unintended_diff_only": -0.0027499794960021973,
        "tpp_threshold_10_total_metric": 0.05300001800060272,
        "tpp_threshold_10_intended_diff_only": 0.054000020027160645,
        "tpp_threshold_10_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_20_total_metric": 0.14124998450279236,
        "tpp_threshold_20_intended_diff_only": 0.15299999713897705,
        "tpp_threshold_20_unintended_diff_only": 0.011750012636184692,
        "tpp_threshold_50_total_metric": 0.22449998557567596,
        "tpp_threshold_50_intended_diff_only": 0.23600000143051147,
        "tpp_threshold_50_unintended_diff_only": 0.01150001585483551,
        "tpp_threshold_100_total_metric": 0.2629999816417694,
        "tpp_threshold_100_intended_diff_only": 0.28299999237060547,
        "tpp_threshold_100_unintended_diff_only": 0.02000001072883606,
        "tpp_threshold_500_total_metric": 0.3360000103712082,
        "tpp_threshold_500_intended_diff_only": 0.36000001430511475,
        "tpp_threshold_500_unintended_diff_only": 0.024000003933906555
      }
    }
  }
}