{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "7e7c14a3-b4ed-48c8-b718-8b2f63838752",
  "datetime_epoch_millis": 1769397206011,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.01112498939037323,
      "tpp_threshold_2_intended_diff_only": 0.01529998779296875,
      "tpp_threshold_2_unintended_diff_only": 0.00417499840259552,
      "tpp_threshold_5_total_metric": 0.01937498599290848,
      "tpp_threshold_5_intended_diff_only": 0.024799984693527222,
      "tpp_threshold_5_unintended_diff_only": 0.005424998700618744,
      "tpp_threshold_10_total_metric": 0.042900012433528895,
      "tpp_threshold_10_intended_diff_only": 0.05000000596046448,
      "tpp_threshold_10_unintended_diff_only": 0.007099993526935577,
      "tpp_threshold_20_total_metric": 0.12977501153945922,
      "tpp_threshold_20_intended_diff_only": 0.1411000072956085,
      "tpp_threshold_20_unintended_diff_only": 0.011324995756149292,
      "tpp_threshold_50_total_metric": 0.3233500152826309,
      "tpp_threshold_50_intended_diff_only": 0.3456000089645386,
      "tpp_threshold_50_unintended_diff_only": 0.02224999368190765,
      "tpp_threshold_100_total_metric": 0.40365002304315567,
      "tpp_threshold_100_intended_diff_only": 0.43720002174377437,
      "tpp_threshold_100_unintended_diff_only": 0.03354999870061874,
      "tpp_threshold_500_total_metric": 0.3633250430226326,
      "tpp_threshold_500_intended_diff_only": 0.44450004100799556,
      "tpp_threshold_500_unintended_diff_only": 0.08117499798536301
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.0035999804735183717,
      "tpp_threshold_2_intended_diff_only": 0.004999971389770508,
      "tpp_threshold_2_unintended_diff_only": 0.0013999909162521363,
      "tpp_threshold_5_total_metric": 0.011849984526634216,
      "tpp_threshold_5_intended_diff_only": 0.014399969577789306,
      "tpp_threshold_5_unintended_diff_only": 0.0025499850511550904,
      "tpp_threshold_10_total_metric": 0.032050004601478575,
      "tpp_threshold_10_intended_diff_only": 0.036199986934661865,
      "tpp_threshold_10_unintended_diff_only": 0.004149982333183288,
      "tpp_threshold_20_total_metric": 0.11130000054836273,
      "tpp_threshold_20_intended_diff_only": 0.1185999870300293,
      "tpp_threshold_20_unintended_diff_only": 0.007299986481666565,
      "tpp_threshold_50_total_metric": 0.3269000083208084,
      "tpp_threshold_50_intended_diff_only": 0.34679999351501467,
      "tpp_threshold_50_unintended_diff_only": 0.019899985194206236,
      "tpp_threshold_100_total_metric": 0.4320500254631042,
      "tpp_threshold_100_intended_diff_only": 0.4592000126838684,
      "tpp_threshold_100_unintended_diff_only": 0.02714998722076416,
      "tpp_threshold_500_total_metric": 0.40475004613399507,
      "tpp_threshold_500_intended_diff_only": 0.4680000305175781,
      "tpp_threshold_500_unintended_diff_only": 0.06324998438358306
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.018649998307228088,
      "tpp_threshold_2_intended_diff_only": 0.02560000419616699,
      "tpp_threshold_2_unintended_diff_only": 0.006950005888938904,
      "tpp_threshold_5_total_metric": 0.02689998745918274,
      "tpp_threshold_5_intended_diff_only": 0.03519999980926514,
      "tpp_threshold_5_unintended_diff_only": 0.008300012350082398,
      "tpp_threshold_10_total_metric": 0.05375002026557922,
      "tpp_threshold_10_intended_diff_only": 0.06380002498626709,
      "tpp_threshold_10_unintended_diff_only": 0.010050004720687867,
      "tpp_threshold_20_total_metric": 0.14825002253055572,
      "tpp_threshold_20_intended_diff_only": 0.16360002756118774,
      "tpp_threshold_20_unintended_diff_only": 0.01535000503063202,
      "tpp_threshold_50_total_metric": 0.3198000222444534,
      "tpp_threshold_50_intended_diff_only": 0.3444000244140625,
      "tpp_threshold_50_unintended_diff_only": 0.02460000216960907,
      "tpp_threshold_100_total_metric": 0.3752500206232071,
      "tpp_threshold_100_intended_diff_only": 0.4152000308036804,
      "tpp_threshold_100_unintended_diff_only": 0.039950010180473325,
      "tpp_threshold_500_total_metric": 0.32190003991127014,
      "tpp_threshold_500_intended_diff_only": 0.4210000514984131,
      "tpp_threshold_500_unintended_diff_only": 0.09910001158714295
    }
  ],
  "sae_bench_commit_hash": "a62015fa6d4f4e93e25cfeaafc350eef7b2ab273",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_matryoshka",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_matryoshka",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0004999786615371704,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_5_total_metric": 0.008249983191490173,
        "tpp_threshold_5_intended_diff_only": 0.011999964714050293,
        "tpp_threshold_5_unintended_diff_only": 0.0037499815225601196,
        "tpp_threshold_10_total_metric": 0.013500019907951355,
        "tpp_threshold_10_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_10_unintended_diff_only": 0.00449998676776886,
        "tpp_threshold_20_total_metric": 0.062499985098838806,
        "tpp_threshold_20_intended_diff_only": 0.07099997997283936,
        "tpp_threshold_20_unintended_diff_only": 0.00849999487400055,
        "tpp_threshold_50_total_metric": 0.33675000071525574,
        "tpp_threshold_50_intended_diff_only": 0.3569999933242798,
        "tpp_threshold_50_unintended_diff_only": 0.020249992609024048,
        "tpp_threshold_100_total_metric": 0.4167500436306,
        "tpp_threshold_100_intended_diff_only": 0.44200003147125244,
        "tpp_threshold_100_unintended_diff_only": 0.025249987840652466,
        "tpp_threshold_500_total_metric": 0.3980000466108322,
        "tpp_threshold_500_intended_diff_only": 0.44700002670288086,
        "tpp_threshold_500_unintended_diff_only": 0.048999980092048645
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0012499839067459106,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": -0.00024999678134918213,
        "tpp_threshold_5_total_metric": 0.001499965786933899,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_10_total_metric": 0.023000001907348633,
        "tpp_threshold_10_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_10_unintended_diff_only": 0.001999974250793457,
        "tpp_threshold_20_total_metric": 0.06749999523162842,
        "tpp_threshold_20_intended_diff_only": 0.07499998807907104,
        "tpp_threshold_20_unintended_diff_only": 0.007499992847442627,
        "tpp_threshold_50_total_metric": 0.3554999977350235,
        "tpp_threshold_50_intended_diff_only": 0.37199997901916504,
        "tpp_threshold_50_unintended_diff_only": 0.01649998128414154,
        "tpp_threshold_100_total_metric": 0.43825002014636993,
        "tpp_threshold_100_intended_diff_only": 0.46299999952316284,
        "tpp_threshold_100_unintended_diff_only": 0.024749979376792908,
        "tpp_threshold_500_total_metric": 0.3840000480413437,
        "tpp_threshold_500_intended_diff_only": 0.4650000333786011,
        "tpp_threshold_500_unintended_diff_only": 0.08099998533725739
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.0032500028610229492,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_5_total_metric": 0.006749987602233887,
        "tpp_threshold_5_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_5_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_10_total_metric": 0.028250038623809814,
        "tpp_threshold_10_intended_diff_only": 0.03100001811981201,
        "tpp_threshold_10_unintended_diff_only": 0.0027499794960021973,
        "tpp_threshold_20_total_metric": 0.06674998998641968,
        "tpp_threshold_20_intended_diff_only": 0.07099997997283936,
        "tpp_threshold_20_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_50_total_metric": 0.32325002551078796,
        "tpp_threshold_50_intended_diff_only": 0.34200000762939453,
        "tpp_threshold_50_unintended_diff_only": 0.018749982118606567,
        "tpp_threshold_100_total_metric": 0.4180000424385071,
        "tpp_threshold_100_intended_diff_only": 0.453000009059906,
        "tpp_threshold_100_unintended_diff_only": 0.034999966621398926,
        "tpp_threshold_500_total_metric": 0.37000006437301636,
        "tpp_threshold_500_intended_diff_only": 0.45500004291534424,
        "tpp_threshold_500_unintended_diff_only": 0.08499997854232788
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0059999823570251465,
        "tpp_threshold_2_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_2_unintended_diff_only": 0.001999974250793457,
        "tpp_threshold_5_total_metric": 0.008999988436698914,
        "tpp_threshold_5_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_5_unintended_diff_only": -0.0020000189542770386,
        "tpp_threshold_10_total_metric": 0.010749995708465576,
        "tpp_threshold_10_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_10_unintended_diff_only": 0.0002499818801879883,
        "tpp_threshold_20_total_metric": 0.027000010013580322,
        "tpp_threshold_20_intended_diff_only": 0.02899998426437378,
        "tpp_threshold_20_unintended_diff_only": 0.001999974250793457,
        "tpp_threshold_50_total_metric": 0.17750000953674316,
        "tpp_threshold_50_intended_diff_only": 0.18599998950958252,
        "tpp_threshold_50_unintended_diff_only": 0.008499979972839355,
        "tpp_threshold_100_total_metric": 0.45100000500679016,
        "tpp_threshold_100_intended_diff_only": 0.4580000042915344,
        "tpp_threshold_100_unintended_diff_only": 0.006999999284744263,
        "tpp_threshold_500_total_metric": 0.46500004827976227,
        "tpp_threshold_500_intended_diff_only": 0.4930000305175781,
        "tpp_threshold_500_unintended_diff_only": 0.027999982237815857
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.006999954581260681,
        "tpp_threshold_2_intended_diff_only": 0.008999943733215332,
        "tpp_threshold_2_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_5_total_metric": 0.03374999761581421,
        "tpp_threshold_5_intended_diff_only": 0.038999974727630615,
        "tpp_threshold_5_unintended_diff_only": 0.005249977111816406,
        "tpp_threshold_10_total_metric": 0.0847499668598175,
        "tpp_threshold_10_intended_diff_only": 0.09599995613098145,
        "tpp_threshold_10_unintended_diff_only": 0.01124998927116394,
        "tpp_threshold_20_total_metric": 0.33275002241134644,
        "tpp_threshold_20_intended_diff_only": 0.34700000286102295,
        "tpp_threshold_20_unintended_diff_only": 0.014249980449676514,
        "tpp_threshold_50_total_metric": 0.4415000081062317,
        "tpp_threshold_50_intended_diff_only": 0.47699999809265137,
        "tpp_threshold_50_unintended_diff_only": 0.03549998998641968,
        "tpp_threshold_100_total_metric": 0.4362500160932541,
        "tpp_threshold_100_intended_diff_only": 0.48000001907348633,
        "tpp_threshold_100_unintended_diff_only": 0.04375000298023224,
        "tpp_threshold_500_total_metric": 0.40675002336502075,
        "tpp_threshold_500_intended_diff_only": 0.48000001907348633,
        "tpp_threshold_500_unintended_diff_only": 0.07324999570846558
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.006499961018562317,
        "tpp_threshold_2_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_2_unintended_diff_only": 0.007500007748603821,
        "tpp_threshold_5_total_metric": -0.006750002503395081,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": 0.006750002503395081,
        "tpp_threshold_10_total_metric": 0.022750049829483032,
        "tpp_threshold_10_intended_diff_only": 0.029000043869018555,
        "tpp_threshold_10_unintended_diff_only": 0.0062499940395355225,
        "tpp_threshold_20_total_metric": 0.16675002872943878,
        "tpp_threshold_20_intended_diff_only": 0.17800003290176392,
        "tpp_threshold_20_unintended_diff_only": 0.011250004172325134,
        "tpp_threshold_50_total_metric": 0.4045000374317169,
        "tpp_threshold_50_intended_diff_only": 0.437000036239624,
        "tpp_threshold_50_unintended_diff_only": 0.032499998807907104,
        "tpp_threshold_100_total_metric": 0.40150004625320435,
        "tpp_threshold_100_intended_diff_only": 0.4440000653266907,
        "tpp_threshold_100_unintended_diff_only": 0.04250001907348633,
        "tpp_threshold_500_total_metric": 0.34925006330013275,
        "tpp_threshold_500_intended_diff_only": 0.4440000653266907,
        "tpp_threshold_500_unintended_diff_only": 0.09475000202655792
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.005250006914138794,
        "tpp_threshold_2_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_2_unintended_diff_only": 0.012749999761581421,
        "tpp_threshold_5_total_metric": 0.0009999871253967285,
        "tpp_threshold_5_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_5_unintended_diff_only": 0.022000014781951904,
        "tpp_threshold_10_total_metric": 0.021500006318092346,
        "tpp_threshold_10_intended_diff_only": 0.04100000858306885,
        "tpp_threshold_10_unintended_diff_only": 0.0195000022649765,
        "tpp_threshold_20_total_metric": 0.06375004351139069,
        "tpp_threshold_20_intended_diff_only": 0.08500003814697266,
        "tpp_threshold_20_unintended_diff_only": 0.02124999463558197,
        "tpp_threshold_50_total_metric": 0.24950000643730164,
        "tpp_threshold_50_intended_diff_only": 0.2770000100135803,
        "tpp_threshold_50_unintended_diff_only": 0.027500003576278687,
        "tpp_threshold_100_total_metric": 0.3669999986886978,
        "tpp_threshold_100_intended_diff_only": 0.42100000381469727,
        "tpp_threshold_100_unintended_diff_only": 0.05400000512599945,
        "tpp_threshold_500_total_metric": 0.31575004756450653,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.12425000965595245
      },
      "3": {
        "tpp_threshold_2_total_metric": 0.02649998664855957,
        "tpp_threshold_2_intended_diff_only": 0.03299999237060547,
        "tpp_threshold_2_unintended_diff_only": 0.0065000057220458984,
        "tpp_threshold_5_total_metric": 0.03999999165534973,
        "tpp_threshold_5_intended_diff_only": 0.046000003814697266,
        "tpp_threshold_5_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_10_total_metric": 0.07075002789497375,
        "tpp_threshold_10_intended_diff_only": 0.08100003004074097,
        "tpp_threshold_10_unintended_diff_only": 0.010250002145767212,
        "tpp_threshold_20_total_metric": 0.11675001680850983,
        "tpp_threshold_20_intended_diff_only": 0.13200002908706665,
        "tpp_threshold_20_unintended_diff_only": 0.015250012278556824,
        "tpp_threshold_50_total_metric": 0.28700001537799835,
        "tpp_threshold_50_intended_diff_only": 0.30400002002716064,
        "tpp_threshold_50_unintended_diff_only": 0.017000004649162292,
        "tpp_threshold_100_total_metric": 0.38200004398822784,
        "tpp_threshold_100_intended_diff_only": 0.4180000424385071,
        "tpp_threshold_100_unintended_diff_only": 0.035999998450279236,
        "tpp_threshold_500_total_metric": 0.3250000476837158,
        "tpp_threshold_500_intended_diff_only": 0.42200005054473877,
        "tpp_threshold_500_unintended_diff_only": 0.09700000286102295
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.008249983191490173,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": -0.0032499879598617554,
        "tpp_threshold_5_total_metric": 0.013249993324279785,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": -0.0002499818801879883,
        "tpp_threshold_10_total_metric": 0.0195000022649765,
        "tpp_threshold_10_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_10_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_20_total_metric": 0.12775000929832458,
        "tpp_threshold_20_intended_diff_only": 0.1380000114440918,
        "tpp_threshold_20_unintended_diff_only": 0.010250002145767212,
        "tpp_threshold_50_total_metric": 0.3185000419616699,
        "tpp_threshold_50_intended_diff_only": 0.33500003814697266,
        "tpp_threshold_50_unintended_diff_only": 0.016499996185302734,
        "tpp_threshold_100_total_metric": 0.3844999819993973,
        "tpp_threshold_100_intended_diff_only": 0.42100000381469727,
        "tpp_threshold_100_unintended_diff_only": 0.03650002181529999,
        "tpp_threshold_500_total_metric": 0.31325002014636993,
        "tpp_threshold_500_intended_diff_only": 0.4270000457763672,
        "tpp_threshold_500_unintended_diff_only": 0.11375002562999725
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.05974997580051422,
        "tpp_threshold_2_intended_diff_only": 0.07099997997283936,
        "tpp_threshold_2_unintended_diff_only": 0.011250004172325134,
        "tpp_threshold_5_total_metric": 0.08699996769428253,
        "tpp_threshold_5_intended_diff_only": 0.09399998188018799,
        "tpp_threshold_5_unintended_diff_only": 0.0070000141859054565,
        "tpp_threshold_10_total_metric": 0.13425001502037048,
        "tpp_threshold_10_intended_diff_only": 0.14600002765655518,
        "tpp_threshold_10_unintended_diff_only": 0.011750012636184692,
        "tpp_threshold_20_total_metric": 0.26625001430511475,
        "tpp_threshold_20_intended_diff_only": 0.2850000262260437,
        "tpp_threshold_20_unintended_diff_only": 0.018750011920928955,
        "tpp_threshold_50_total_metric": 0.3395000100135803,
        "tpp_threshold_50_intended_diff_only": 0.36900001764297485,
        "tpp_threshold_50_unintended_diff_only": 0.02950000762939453,
        "tpp_threshold_100_total_metric": 0.3412500321865082,
        "tpp_threshold_100_intended_diff_only": 0.3720000386238098,
        "tpp_threshold_100_unintended_diff_only": 0.030750006437301636,
        "tpp_threshold_500_total_metric": 0.30625002086162567,
        "tpp_threshold_500_intended_diff_only": 0.3720000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.06575001776218414
      }
    }
  }
}