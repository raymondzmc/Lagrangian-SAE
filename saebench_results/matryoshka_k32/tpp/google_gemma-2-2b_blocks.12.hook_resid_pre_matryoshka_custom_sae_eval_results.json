{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "0d967db5-a3a6-4d45-b69b-3b780ef2594c",
  "datetime_epoch_millis": 1769329458992,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0062499970197677605,
      "tpp_threshold_2_intended_diff_only": 0.0075999915599823005,
      "tpp_threshold_2_unintended_diff_only": 0.0013499945402145387,
      "tpp_threshold_5_total_metric": 0.013674993813037873,
      "tpp_threshold_5_intended_diff_only": 0.016299986839294435,
      "tpp_threshold_5_unintended_diff_only": 0.002624993026256561,
      "tpp_threshold_10_total_metric": 0.04122500717639923,
      "tpp_threshold_10_intended_diff_only": 0.045600003004074095,
      "tpp_threshold_10_unintended_diff_only": 0.004374995827674866,
      "tpp_threshold_20_total_metric": 0.05982499569654465,
      "tpp_threshold_20_intended_diff_only": 0.06649999618530274,
      "tpp_threshold_20_unintended_diff_only": 0.0066750004887580865,
      "tpp_threshold_50_total_metric": 0.10877499282360077,
      "tpp_threshold_50_intended_diff_only": 0.12139999270439147,
      "tpp_threshold_50_unintended_diff_only": 0.012624999880790709,
      "tpp_threshold_100_total_metric": 0.15270000398159028,
      "tpp_threshold_100_intended_diff_only": 0.16990000605583191,
      "tpp_threshold_100_unintended_diff_only": 0.01720000207424164,
      "tpp_threshold_500_total_metric": 0.22535001039505004,
      "tpp_threshold_500_intended_diff_only": 0.2472000062465668,
      "tpp_threshold_500_unintended_diff_only": 0.021849995851516722
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.00529998242855072,
      "tpp_threshold_2_intended_diff_only": 0.006199967861175537,
      "tpp_threshold_2_unintended_diff_only": 0.0008999854326248169,
      "tpp_threshold_5_total_metric": 0.009350007772445679,
      "tpp_threshold_5_intended_diff_only": 0.011599981784820556,
      "tpp_threshold_5_unintended_diff_only": 0.002249974012374878,
      "tpp_threshold_10_total_metric": 0.022049996256828307,
      "tpp_threshold_10_intended_diff_only": 0.02639998197555542,
      "tpp_threshold_10_unintended_diff_only": 0.0043499857187271115,
      "tpp_threshold_20_total_metric": 0.04184999167919159,
      "tpp_threshold_20_intended_diff_only": 0.04799997806549072,
      "tpp_threshold_20_unintended_diff_only": 0.006149986386299133,
      "tpp_threshold_50_total_metric": 0.09375,
      "tpp_threshold_50_intended_diff_only": 0.10739998817443848,
      "tpp_threshold_50_unintended_diff_only": 0.013649988174438476,
      "tpp_threshold_100_total_metric": 0.14340001046657563,
      "tpp_threshold_100_intended_diff_only": 0.1593999981880188,
      "tpp_threshold_100_unintended_diff_only": 0.015999987721443176,
      "tpp_threshold_500_total_metric": 0.22695000767707824,
      "tpp_threshold_500_intended_diff_only": 0.24839998483657838,
      "tpp_threshold_500_unintended_diff_only": 0.021449977159500123
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.007200011610984802,
      "tpp_threshold_2_intended_diff_only": 0.009000015258789063,
      "tpp_threshold_2_unintended_diff_only": 0.0018000036478042602,
      "tpp_threshold_5_total_metric": 0.017999979853630065,
      "tpp_threshold_5_intended_diff_only": 0.020999991893768312,
      "tpp_threshold_5_unintended_diff_only": 0.0030000120401382445,
      "tpp_threshold_10_total_metric": 0.060400018095970155,
      "tpp_threshold_10_intended_diff_only": 0.06480002403259277,
      "tpp_threshold_10_unintended_diff_only": 0.00440000593662262,
      "tpp_threshold_20_total_metric": 0.0777999997138977,
      "tpp_threshold_20_intended_diff_only": 0.08500001430511475,
      "tpp_threshold_20_unintended_diff_only": 0.007200014591217041,
      "tpp_threshold_50_total_metric": 0.12379998564720154,
      "tpp_threshold_50_intended_diff_only": 0.13539999723434448,
      "tpp_threshold_50_unintended_diff_only": 0.011600011587142944,
      "tpp_threshold_100_total_metric": 0.16199999749660493,
      "tpp_threshold_100_intended_diff_only": 0.18040001392364502,
      "tpp_threshold_100_unintended_diff_only": 0.0184000164270401,
      "tpp_threshold_500_total_metric": 0.22375001311302184,
      "tpp_threshold_500_intended_diff_only": 0.24600002765655518,
      "tpp_threshold_500_unintended_diff_only": 0.022250014543533325
    }
  ],
  "sae_bench_commit_hash": "49a408278084c854a29b369c4c9950f9d954c00e",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_matryoshka",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_matryoshka",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0024999678134918213,
        "tpp_threshold_2_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_2_unintended_diff_only": 0.0004999935626983643,
        "tpp_threshold_5_total_metric": 0.0017500221729278564,
        "tpp_threshold_5_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": 0.0032499730587005615,
        "tpp_threshold_10_total_metric": 0.005750015377998352,
        "tpp_threshold_10_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_10_unintended_diff_only": 0.004249975085258484,
        "tpp_threshold_20_total_metric": 0.03249996900558472,
        "tpp_threshold_20_intended_diff_only": 0.039999961853027344,
        "tpp_threshold_20_unintended_diff_only": 0.007499992847442627,
        "tpp_threshold_50_total_metric": 0.06274999678134918,
        "tpp_threshold_50_intended_diff_only": 0.07599997520446777,
        "tpp_threshold_50_unintended_diff_only": 0.013249978423118591,
        "tpp_threshold_100_total_metric": 0.11049997806549072,
        "tpp_threshold_100_intended_diff_only": 0.13199996948242188,
        "tpp_threshold_100_unintended_diff_only": 0.021499991416931152,
        "tpp_threshold_500_total_metric": 0.23474998772144318,
        "tpp_threshold_500_intended_diff_only": 0.26099997758865356,
        "tpp_threshold_500_unintended_diff_only": 0.026249989867210388
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.005000010132789612,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_5_total_metric": 0.005499988794326782,
        "tpp_threshold_5_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_5_unintended_diff_only": 0.0014999806880950928,
        "tpp_threshold_10_total_metric": 0.025999993085861206,
        "tpp_threshold_10_intended_diff_only": 0.02899998426437378,
        "tpp_threshold_10_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_20_total_metric": 0.04050000011920929,
        "tpp_threshold_20_intended_diff_only": 0.04799997806549072,
        "tpp_threshold_20_unintended_diff_only": 0.007499977946281433,
        "tpp_threshold_50_total_metric": 0.17274999618530273,
        "tpp_threshold_50_intended_diff_only": 0.19999998807907104,
        "tpp_threshold_50_unintended_diff_only": 0.02724999189376831,
        "tpp_threshold_100_total_metric": 0.23850002884864807,
        "tpp_threshold_100_intended_diff_only": 0.2670000195503235,
        "tpp_threshold_100_unintended_diff_only": 0.028499990701675415,
        "tpp_threshold_500_total_metric": 0.34400004148483276,
        "tpp_threshold_500_intended_diff_only": 0.3790000081062317,
        "tpp_threshold_500_unintended_diff_only": 0.034999966621398926
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.006499990820884705,
        "tpp_threshold_2_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": 0.0004999786615371704,
        "tpp_threshold_5_total_metric": 0.0037500113248825073,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.002249971032142639,
        "tpp_threshold_10_total_metric": 0.015499994158744812,
        "tpp_threshold_10_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_10_unintended_diff_only": 0.00449998676776886,
        "tpp_threshold_20_total_metric": 0.030750036239624023,
        "tpp_threshold_20_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_20_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_50_total_metric": 0.08750003576278687,
        "tpp_threshold_50_intended_diff_only": 0.10000002384185791,
        "tpp_threshold_50_unintended_diff_only": 0.012499988079071045,
        "tpp_threshold_100_total_metric": 0.16475005447864532,
        "tpp_threshold_100_intended_diff_only": 0.17800003290176392,
        "tpp_threshold_100_unintended_diff_only": 0.013249978423118591,
        "tpp_threshold_500_total_metric": 0.25575004518032074,
        "tpp_threshold_500_intended_diff_only": 0.2770000100135803,
        "tpp_threshold_500_unintended_diff_only": 0.021249964833259583
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.006749972701072693,
        "tpp_threshold_2_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_2_unintended_diff_only": 0.0012499839067459106,
        "tpp_threshold_5_total_metric": 0.004249989986419678,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": -0.0012500286102294922,
        "tpp_threshold_10_total_metric": 0.006249979138374329,
        "tpp_threshold_10_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_10_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_20_total_metric": 0.008499979972839355,
        "tpp_threshold_20_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_20_unintended_diff_only": -0.0015000104904174805,
        "tpp_threshold_50_total_metric": 0.009249985218048096,
        "tpp_threshold_50_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_50_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_100_total_metric": 0.00599999725818634,
        "tpp_threshold_100_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_100_unintended_diff_only": 0.004999980330467224,
        "tpp_threshold_500_total_metric": 0.02574998140335083,
        "tpp_threshold_500_intended_diff_only": 0.030999958515167236,
        "tpp_threshold_500_unintended_diff_only": 0.005249977111816406
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.0057499706745147705,
        "tpp_threshold_2_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_2_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_5_total_metric": 0.03150002658367157,
        "tpp_threshold_5_intended_diff_only": 0.03700000047683716,
        "tpp_threshold_5_unintended_diff_only": 0.005499973893165588,
        "tpp_threshold_10_total_metric": 0.05674999952316284,
        "tpp_threshold_10_intended_diff_only": 0.06599998474121094,
        "tpp_threshold_10_unintended_diff_only": 0.009249985218048096,
        "tpp_threshold_20_total_metric": 0.09699997305870056,
        "tpp_threshold_20_intended_diff_only": 0.10999995470046997,
        "tpp_threshold_20_unintended_diff_only": 0.01299998164176941,
        "tpp_threshold_50_total_metric": 0.13649998605251312,
        "tpp_threshold_50_intended_diff_only": 0.1499999761581421,
        "tpp_threshold_50_unintended_diff_only": 0.013499990105628967,
        "tpp_threshold_100_total_metric": 0.19724999368190765,
        "tpp_threshold_100_intended_diff_only": 0.20899999141693115,
        "tpp_threshold_100_unintended_diff_only": 0.011749997735023499,
        "tpp_threshold_500_total_metric": 0.2744999825954437,
        "tpp_threshold_500_intended_diff_only": 0.29399996995925903,
        "tpp_threshold_500_unintended_diff_only": 0.019499987363815308
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.008500009775161743,
        "tpp_threshold_2_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_5_total_metric": -0.007750019431114197,
        "tpp_threshold_5_intended_diff_only": -0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": 0.002750024199485779,
        "tpp_threshold_10_total_metric": -0.001499965786933899,
        "tpp_threshold_10_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_10_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_20_total_metric": -0.0020000040531158447,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_50_total_metric": 0.027500003576278687,
        "tpp_threshold_50_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_50_unintended_diff_only": -0.0004999935626983643,
        "tpp_threshold_100_total_metric": 0.045249998569488525,
        "tpp_threshold_100_intended_diff_only": 0.050000011920928955,
        "tpp_threshold_100_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_500_total_metric": 0.09399999678134918,
        "tpp_threshold_500_intended_diff_only": 0.10500001907348633,
        "tpp_threshold_500_unintended_diff_only": 0.011000022292137146
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.018500030040740967,
        "tpp_threshold_2_intended_diff_only": 0.016000032424926758,
        "tpp_threshold_2_unintended_diff_only": -0.002499997615814209,
        "tpp_threshold_5_total_metric": 0.007749959826469421,
        "tpp_threshold_5_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_5_unintended_diff_only": 0.0072500258684158325,
        "tpp_threshold_10_total_metric": 0.02575002610683441,
        "tpp_threshold_10_intended_diff_only": 0.030000030994415283,
        "tpp_threshold_10_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_20_total_metric": 0.037250012159347534,
        "tpp_threshold_20_intended_diff_only": 0.04400002956390381,
        "tpp_threshold_20_unintended_diff_only": 0.006750017404556274,
        "tpp_threshold_50_total_metric": 0.06874999403953552,
        "tpp_threshold_50_intended_diff_only": 0.07899999618530273,
        "tpp_threshold_50_unintended_diff_only": 0.010250002145767212,
        "tpp_threshold_100_total_metric": 0.11124998331069946,
        "tpp_threshold_100_intended_diff_only": 0.1290000081062317,
        "tpp_threshold_100_unintended_diff_only": 0.017750024795532227,
        "tpp_threshold_500_total_metric": 0.17200005054473877,
        "tpp_threshold_500_intended_diff_only": 0.1860000491142273,
        "tpp_threshold_500_unintended_diff_only": 0.013999998569488525
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.0034999698400497437,
        "tpp_threshold_2_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_5_total_metric": 0.0010000169277191162,
        "tpp_threshold_5_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_10_total_metric": 0.025500014424324036,
        "tpp_threshold_10_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_10_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_20_total_metric": 0.05299997329711914,
        "tpp_threshold_20_intended_diff_only": 0.06099998950958252,
        "tpp_threshold_20_unintended_diff_only": 0.008000016212463379,
        "tpp_threshold_50_total_metric": 0.11299997568130493,
        "tpp_threshold_50_intended_diff_only": 0.14399999380111694,
        "tpp_threshold_50_unintended_diff_only": 0.03100001811981201,
        "tpp_threshold_100_total_metric": 0.16600002348423004,
        "tpp_threshold_100_intended_diff_only": 0.21100002527236938,
        "tpp_threshold_100_unintended_diff_only": 0.04500000178813934,
        "tpp_threshold_500_total_metric": 0.24899999797344208,
        "tpp_threshold_500_intended_diff_only": 0.30400002002716064,
        "tpp_threshold_500_unintended_diff_only": 0.05500002205371857
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.01199999451637268,
        "tpp_threshold_2_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": -0.0029999911785125732,
        "tpp_threshold_5_total_metric": 0.015499964356422424,
        "tpp_threshold_5_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_5_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_10_total_metric": 0.02800002694129944,
        "tpp_threshold_10_intended_diff_only": 0.030000030994415283,
        "tpp_threshold_10_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_20_total_metric": 0.05150000751018524,
        "tpp_threshold_20_intended_diff_only": 0.054000020027160645,
        "tpp_threshold_20_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_50_total_metric": 0.10599999129772186,
        "tpp_threshold_50_intended_diff_only": 0.11100000143051147,
        "tpp_threshold_50_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_100_total_metric": 0.1510000228881836,
        "tpp_threshold_100_intended_diff_only": 0.15900003910064697,
        "tpp_threshold_100_unintended_diff_only": 0.008000016212463379,
        "tpp_threshold_500_total_metric": 0.2580000013113022,
        "tpp_threshold_500_intended_diff_only": 0.2670000195503235,
        "tpp_threshold_500_unintended_diff_only": 0.009000018239021301
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.01750001311302185,
        "tpp_threshold_2_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_2_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_5_total_metric": 0.07349997758865356,
        "tpp_threshold_5_intended_diff_only": 0.07499998807907104,
        "tpp_threshold_5_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_10_total_metric": 0.22424998879432678,
        "tpp_threshold_10_intended_diff_only": 0.23600000143051147,
        "tpp_threshold_10_unintended_diff_only": 0.011750012636184692,
        "tpp_threshold_20_total_metric": 0.24925000965595245,
        "tpp_threshold_20_intended_diff_only": 0.26200002431869507,
        "tpp_threshold_20_unintended_diff_only": 0.012750014662742615,
        "tpp_threshold_50_total_metric": 0.3037499636411667,
        "tpp_threshold_50_intended_diff_only": 0.31599998474121094,
        "tpp_threshold_50_unintended_diff_only": 0.01225002110004425,
        "tpp_threshold_100_total_metric": 0.336499959230423,
        "tpp_threshold_100_intended_diff_only": 0.3529999852180481,
        "tpp_threshold_100_unintended_diff_only": 0.016500025987625122,
        "tpp_threshold_500_total_metric": 0.34575001895427704,
        "tpp_threshold_500_intended_diff_only": 0.3680000305175781,
        "tpp_threshold_500_unintended_diff_only": 0.022250011563301086
      }
    }
  }
}