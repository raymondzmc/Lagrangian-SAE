{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 2,
    "llm_batch_size": 16,
    "llm_dtype": "bfloat16",
    "lower_vram_usage": true,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "57b5a2d0-3cd8-4ee2-ab99-a8478edcfb58",
  "datetime_epoch_millis": 1769400964584,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.004575000703334808,
      "tpp_threshold_2_intended_diff_only": 0.005699998140335083,
      "tpp_threshold_2_unintended_diff_only": 0.0011249974370002747,
      "tpp_threshold_5_total_metric": 0.010274995863437653,
      "tpp_threshold_5_intended_diff_only": 0.011299991607666015,
      "tpp_threshold_5_unintended_diff_only": 0.0010249957442283629,
      "tpp_threshold_10_total_metric": 0.022649991512298583,
      "tpp_threshold_10_intended_diff_only": 0.024899989366531372,
      "tpp_threshold_10_unintended_diff_only": 0.002249997854232788,
      "tpp_threshold_20_total_metric": 0.037775009870529175,
      "tpp_threshold_20_intended_diff_only": 0.040700006484985354,
      "tpp_threshold_20_unintended_diff_only": 0.002924996614456177,
      "tpp_threshold_50_total_metric": 0.12062500417232513,
      "tpp_threshold_50_intended_diff_only": 0.1330000042915344,
      "tpp_threshold_50_unintended_diff_only": 0.012375000119209289,
      "tpp_threshold_100_total_metric": 0.22007501721382142,
      "tpp_threshold_100_intended_diff_only": 0.24460001587867736,
      "tpp_threshold_100_unintended_diff_only": 0.024524998664855958,
      "tpp_threshold_500_total_metric": 0.3997750177979469,
      "tpp_threshold_500_intended_diff_only": 0.4372000217437744,
      "tpp_threshold_500_unintended_diff_only": 0.037425003945827484
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.003899991512298584,
      "tpp_threshold_2_intended_diff_only": 0.005199980735778808,
      "tpp_threshold_2_unintended_diff_only": 0.0012999892234802247,
      "tpp_threshold_5_total_metric": 0.006749996542930603,
      "tpp_threshold_5_intended_diff_only": 0.007799983024597168,
      "tpp_threshold_5_unintended_diff_only": 0.0010499864816665649,
      "tpp_threshold_10_total_metric": 0.01179998517036438,
      "tpp_threshold_10_intended_diff_only": 0.013599967956542969,
      "tpp_threshold_10_unintended_diff_only": 0.001799982786178589,
      "tpp_threshold_20_total_metric": 0.031000009179115294,
      "tpp_threshold_20_intended_diff_only": 0.033199989795684816,
      "tpp_threshold_20_unintended_diff_only": 0.002199980616569519,
      "tpp_threshold_50_total_metric": 0.1124000072479248,
      "tpp_threshold_50_intended_diff_only": 0.13199999332427978,
      "tpp_threshold_50_unintended_diff_only": 0.01959998607635498,
      "tpp_threshold_100_total_metric": 0.2340000241994858,
      "tpp_threshold_100_intended_diff_only": 0.27100000381469724,
      "tpp_threshold_100_unintended_diff_only": 0.03699997961521149,
      "tpp_threshold_500_total_metric": 0.4092500239610672,
      "tpp_threshold_500_intended_diff_only": 0.4598000168800354,
      "tpp_threshold_500_unintended_diff_only": 0.0505499929189682
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.005250009894371033,
      "tpp_threshold_2_intended_diff_only": 0.006200015544891357,
      "tpp_threshold_2_unintended_diff_only": 0.0009500056505203248,
      "tpp_threshold_5_total_metric": 0.013799995183944702,
      "tpp_threshold_5_intended_diff_only": 0.014800000190734863,
      "tpp_threshold_5_unintended_diff_only": 0.001000005006790161,
      "tpp_threshold_10_total_metric": 0.033499997854232785,
      "tpp_threshold_10_intended_diff_only": 0.03620001077651978,
      "tpp_threshold_10_unintended_diff_only": 0.002700012922286987,
      "tpp_threshold_20_total_metric": 0.044550010561943056,
      "tpp_threshold_20_intended_diff_only": 0.048200023174285886,
      "tpp_threshold_20_unintended_diff_only": 0.0036500126123428346,
      "tpp_threshold_50_total_metric": 0.12885000109672545,
      "tpp_threshold_50_intended_diff_only": 0.13400001525878907,
      "tpp_threshold_50_unintended_diff_only": 0.005150014162063598,
      "tpp_threshold_100_total_metric": 0.20615001022815704,
      "tpp_threshold_100_intended_diff_only": 0.21820002794265747,
      "tpp_threshold_100_unintended_diff_only": 0.012050017714500427,
      "tpp_threshold_500_total_metric": 0.39030001163482664,
      "tpp_threshold_500_intended_diff_only": 0.41460002660751344,
      "tpp_threshold_500_unintended_diff_only": 0.024300014972686766
    }
  ],
  "sae_bench_commit_hash": "bcb8cfe0e327661851a33dcd1db5ff709206b410",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "google/gemma-2-2b_blocks.12.hook_resid_pre_lagrangian",
  "sae_lens_version": "6.30.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 65536,
    "hook_layer": 12,
    "hook_name": "blocks.12.hook_resid_pre",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "lagrangian_sae_lagrangian",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": 512000000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0012499988079071045,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.0007499754428863525,
        "tpp_threshold_5_total_metric": 0.0032499730587005615,
        "tpp_threshold_5_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_5_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_10_total_metric": 0.004749983549118042,
        "tpp_threshold_10_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_10_unintended_diff_only": 0.0032499730587005615,
        "tpp_threshold_20_total_metric": 0.024000003933906555,
        "tpp_threshold_20_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_20_unintended_diff_only": 0.003999993205070496,
        "tpp_threshold_50_total_metric": 0.040999963879585266,
        "tpp_threshold_50_intended_diff_only": 0.04499995708465576,
        "tpp_threshold_50_unintended_diff_only": 0.003999993205070496,
        "tpp_threshold_100_total_metric": 0.1574999988079071,
        "tpp_threshold_100_intended_diff_only": 0.1679999828338623,
        "tpp_threshold_100_unintended_diff_only": 0.0104999840259552,
        "tpp_threshold_500_total_metric": 0.39900003373622894,
        "tpp_threshold_500_intended_diff_only": 0.43400001525878906,
        "tpp_threshold_500_unintended_diff_only": 0.03499998152256012
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.001999959349632263,
        "tpp_threshold_2_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_2_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_5_total_metric": 0.0072500258684158325,
        "tpp_threshold_5_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_5_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_10_total_metric": 0.016999974846839905,
        "tpp_threshold_10_intended_diff_only": 0.01699995994567871,
        "tpp_threshold_10_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_20_total_metric": 0.021250024437904358,
        "tpp_threshold_20_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_20_unintended_diff_only": 0.001749977469444275,
        "tpp_threshold_50_total_metric": 0.27400000393390656,
        "tpp_threshold_50_intended_diff_only": 0.3100000023841858,
        "tpp_threshold_50_unintended_diff_only": 0.035999998450279236,
        "tpp_threshold_100_total_metric": 0.37800005078315735,
        "tpp_threshold_100_intended_diff_only": 0.4240000247955322,
        "tpp_threshold_100_unintended_diff_only": 0.04599997401237488,
        "tpp_threshold_500_total_metric": 0.4045000374317169,
        "tpp_threshold_500_intended_diff_only": 0.4650000333786011,
        "tpp_threshold_500_unintended_diff_only": 0.060499995946884155
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.0065000057220458984,
        "tpp_threshold_2_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_5_total_metric": 0.012250006198883057,
        "tpp_threshold_5_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_5_unintended_diff_only": 0.0027499794960021973,
        "tpp_threshold_10_total_metric": 0.030750006437301636,
        "tpp_threshold_10_intended_diff_only": 0.03299999237060547,
        "tpp_threshold_10_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_20_total_metric": 0.07775002717971802,
        "tpp_threshold_20_intended_diff_only": 0.0820000171661377,
        "tpp_threshold_20_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_50_total_metric": 0.15150004625320435,
        "tpp_threshold_50_intended_diff_only": 0.1600000262260437,
        "tpp_threshold_50_unintended_diff_only": 0.008499979972839355,
        "tpp_threshold_100_total_metric": 0.27250003814697266,
        "tpp_threshold_100_intended_diff_only": 0.28600001335144043,
        "tpp_threshold_100_unintended_diff_only": 0.013499975204467773,
        "tpp_threshold_500_total_metric": 0.4255000352859497,
        "tpp_threshold_500_intended_diff_only": 0.4520000219345093,
        "tpp_threshold_500_unintended_diff_only": 0.02649998664855957
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.010499998927116394,
        "tpp_threshold_2_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_2_unintended_diff_only": 0.0004999786615371704,
        "tpp_threshold_5_total_metric": 0.00849999487400055,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": -0.002500012516975403,
        "tpp_threshold_10_total_metric": 0.007999971508979797,
        "tpp_threshold_10_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_10_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_20_total_metric": 0.013250008225440979,
        "tpp_threshold_20_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_20_unintended_diff_only": -0.0022500306367874146,
        "tpp_threshold_50_total_metric": 0.030249997973442078,
        "tpp_threshold_50_intended_diff_only": 0.0339999794960022,
        "tpp_threshold_50_unintended_diff_only": 0.0037499815225601196,
        "tpp_threshold_100_total_metric": 0.07750003039836884,
        "tpp_threshold_100_intended_diff_only": 0.08300000429153442,
        "tpp_threshold_100_unintended_diff_only": 0.005499973893165588,
        "tpp_threshold_500_total_metric": 0.45649999380111694,
        "tpp_threshold_500_intended_diff_only": 0.46799999475479126,
        "tpp_threshold_500_unintended_diff_only": 0.011500000953674316
      },
      "9": {
        "tpp_threshold_2_total_metric": -0.0007500052452087402,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_5_total_metric": 0.002499982714653015,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": 0.0004999786615371704,
        "tpp_threshold_10_total_metric": -0.0015000104904174805,
        "tpp_threshold_10_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_10_unintended_diff_only": 0.0034999847412109375,
        "tpp_threshold_20_total_metric": 0.018749982118606567,
        "tpp_threshold_20_intended_diff_only": 0.02199995517730713,
        "tpp_threshold_20_unintended_diff_only": 0.0032499730587005615,
        "tpp_threshold_50_total_metric": 0.06525002419948578,
        "tpp_threshold_50_intended_diff_only": 0.11100000143051147,
        "tpp_threshold_50_unintended_diff_only": 0.045749977231025696,
        "tpp_threshold_100_total_metric": 0.28450000286102295,
        "tpp_threshold_100_intended_diff_only": 0.39399999380111694,
        "tpp_threshold_100_unintended_diff_only": 0.109499990940094,
        "tpp_threshold_500_total_metric": 0.3607500195503235,
        "tpp_threshold_500_intended_diff_only": 0.48000001907348633,
        "tpp_threshold_500_unintended_diff_only": 0.11924999952316284
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.004499956965446472,
        "tpp_threshold_2_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_2_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_5_total_metric": -0.004749998450279236,
        "tpp_threshold_5_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_10_total_metric": 0.001749977469444275,
        "tpp_threshold_10_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_unintended_diff_only": 0.003250017762184143,
        "tpp_threshold_20_total_metric": 0.007750019431114197,
        "tpp_threshold_20_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_20_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_50_total_metric": 0.06250002980232239,
        "tpp_threshold_50_intended_diff_only": 0.06300002336502075,
        "tpp_threshold_50_unintended_diff_only": 0.0004999935626983643,
        "tpp_threshold_100_total_metric": 0.11800000071525574,
        "tpp_threshold_100_intended_diff_only": 0.12300002574920654,
        "tpp_threshold_100_unintended_diff_only": 0.005000025033950806,
        "tpp_threshold_500_total_metric": 0.41875000298023224,
        "tpp_threshold_500_intended_diff_only": 0.43800002336502075,
        "tpp_threshold_500_unintended_diff_only": 0.019250020384788513
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.02150002121925354,
        "tpp_threshold_2_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_2_unintended_diff_only": -0.004500001668930054,
        "tpp_threshold_5_total_metric": 0.022499993443489075,
        "tpp_threshold_5_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_5_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_10_total_metric": 0.050000011920928955,
        "tpp_threshold_10_intended_diff_only": 0.054000020027160645,
        "tpp_threshold_10_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_total_metric": 0.06025002896785736,
        "tpp_threshold_20_intended_diff_only": 0.06600004434585571,
        "tpp_threshold_20_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_50_total_metric": 0.1457500010728836,
        "tpp_threshold_50_intended_diff_only": 0.156000018119812,
        "tpp_threshold_50_unintended_diff_only": 0.010250017046928406,
        "tpp_threshold_100_total_metric": 0.2265000343322754,
        "tpp_threshold_100_intended_diff_only": 0.2420000433921814,
        "tpp_threshold_100_unintended_diff_only": 0.015500009059906006,
        "tpp_threshold_500_total_metric": 0.4095000624656677,
        "tpp_threshold_500_intended_diff_only": 0.43500006198883057,
        "tpp_threshold_500_unintended_diff_only": 0.025499999523162842
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.00849999487400055,
        "tpp_threshold_2_intended_diff_only": -0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_5_total_metric": 0.001999974250793457,
        "tpp_threshold_5_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": -0.0009999871253967285,
        "tpp_threshold_10_total_metric": 0.014750033617019653,
        "tpp_threshold_10_intended_diff_only": 0.016000032424926758,
        "tpp_threshold_10_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_20_total_metric": 0.021749988198280334,
        "tpp_threshold_20_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_20_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_50_total_metric": 0.11725001037120819,
        "tpp_threshold_50_intended_diff_only": 0.12300002574920654,
        "tpp_threshold_50_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_100_total_metric": 0.18050001561641693,
        "tpp_threshold_100_intended_diff_only": 0.20600003004074097,
        "tpp_threshold_100_unintended_diff_only": 0.025500014424324036,
        "tpp_threshold_500_total_metric": 0.3777499943971634,
        "tpp_threshold_500_intended_diff_only": 0.42000001668930054,
        "tpp_threshold_500_unintended_diff_only": 0.042250022292137146
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.006250008940696716,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": -0.0032499879598617554,
        "tpp_threshold_5_total_metric": 0.012000024318695068,
        "tpp_threshold_5_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_5_unintended_diff_only": 0.0,
        "tpp_threshold_10_total_metric": 0.01874999701976776,
        "tpp_threshold_10_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_10_unintended_diff_only": 0.003250017762184143,
        "tpp_threshold_20_total_metric": 0.026500001549720764,
        "tpp_threshold_20_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_20_unintended_diff_only": -0.0004999786615371704,
        "tpp_threshold_50_total_metric": 0.09324999153614044,
        "tpp_threshold_50_intended_diff_only": 0.09700000286102295,
        "tpp_threshold_50_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_100_total_metric": 0.19474998116493225,
        "tpp_threshold_100_intended_diff_only": 0.203000009059906,
        "tpp_threshold_100_unintended_diff_only": 0.008250027894973755,
        "tpp_threshold_500_total_metric": 0.3894999772310257,
        "tpp_threshold_500_intended_diff_only": 0.40799999237060547,
        "tpp_threshold_500_unintended_diff_only": 0.018500015139579773
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.011499971151351929,
        "tpp_threshold_2_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_2_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_5_total_metric": 0.037249982357025146,
        "tpp_threshold_5_intended_diff_only": 0.0339999794960022,
        "tpp_threshold_5_unintended_diff_only": -0.0032500028610229492,
        "tpp_threshold_10_total_metric": 0.0822499692440033,
        "tpp_threshold_10_intended_diff_only": 0.08399999141693115,
        "tpp_threshold_10_unintended_diff_only": 0.0017500221729278564,
        "tpp_threshold_20_total_metric": 0.10650001466274261,
        "tpp_threshold_20_intended_diff_only": 0.10900002717971802,
        "tpp_threshold_20_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_50_total_metric": 0.2254999727010727,
        "tpp_threshold_50_intended_diff_only": 0.23100000619888306,
        "tpp_threshold_50_unintended_diff_only": 0.005500033497810364,
        "tpp_threshold_100_total_metric": 0.3110000193119049,
        "tpp_threshold_100_intended_diff_only": 0.31700003147125244,
        "tpp_threshold_100_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_500_total_metric": 0.35600002110004425,
        "tpp_threshold_500_intended_diff_only": 0.3720000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.016000017523765564
      }
    }
  }
}